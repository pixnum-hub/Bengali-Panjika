<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">

<!-- Theme & Mobile Web App -->
<meta name="theme-color" content="#d4a030" id="metaTheme">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ">
<meta name="mobile-web-app-capable" content="yes">
<meta name="application-name" content="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" sizes="192x192" href="icon-192.png">
<link rel="apple-touch-icon" sizes="512x512" href="icon-512.png">

<!-- Favicon -->
<link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
<link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">

<!-- SEO & Social -->
<meta name="description" content="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‚Äî ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó, ‡¶§‡¶ø‡¶•‡¶ø, ‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞, ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‡¶ì ‡¶â‡ßé‡¶∏‡¶¨ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ‡•§ ¬© Manik Roy 2026">
<meta name="author" content="Manik Roy">
<meta property="og:title" content="‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ">
<meta property="og:description" content="‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó, ‡¶§‡¶ø‡¶•‡¶ø, ‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞, ‡ß®‡ß´ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‡¶ì ‡¶â‡ßé‡¶∏‡¶¨ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ">
<meta property="og:image" content="icon-512.png">
<meta property="og:type" content="website">

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Bengali:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0c0c18;--bg2:#13132a;--bg3:#1a1a38;--bg4:#222248;
  --text:#ede5d8;--text2:#8888aa;--text3:#4a4a70;
  --accent:#d4a030;--accent2:#f0c848;--accent3:#7744cc;--accent4:#3399ff;
  --border:#252550;--card:#101025;--cell:#141430;
  --today-bg:#2a1e00;--today-bd:#d4a030;
  --sel-bg:#180a38;--sel-bd:#7744cc;
  --fdot:#ff3355;--mdot:#3399ff;
  --good:#44bb55;--bad:#ee4444;--neutral:#ff9900;
  --shadow:0 8px 48px rgba(0,0,0,.65);
  --hg:linear-gradient(150deg,#1c0a48 0%,#091828 55%,#1c0818 100%);
}
.L{
  --bg:#f6f1e7;--bg2:#ede6d5;--bg3:#e2d8c2;--bg4:#d4c8a0;
  --text:#1a1205;--text2:#6b5030;--text3:#9a7040;
  --accent:#8b5500;--accent2:#b07800;--accent3:#5828aa;--accent4:#1a70cc;
  --border:#c8b888;--card:#fdf8ef;--cell:#f8f3e6;
  --today-bg:#fff3bb;--today-bd:#b07800;
  --sel-bg:#eaddff;--sel-bd:#5828aa;
  --fdot:#cc1133;--mdot:#1a70cc;
  --shadow:0 8px 48px rgba(0,0,0,.14);
  --hg:linear-gradient(150deg,#3a1870 0%,#182858 55%,#38103a 100%);
}
.O{
  --bg:#000;--bg2:#060606;--bg3:#0c0c0c;--bg4:#111;
  --text:#fff;--text2:#686868;--text3:#363636;
  --accent:#f0a820;--accent2:#ffd040;--accent3:#aa44ff;--accent4:#44aaff;
  --border:#1a1a1a;--card:#000;--cell:#040408;
  --today-bg:#180e00;--today-bd:#f0a820;
  --sel-bg:#08002a;--sel-bd:#aa44ff;
  --fdot:#ff2244;--mdot:#44aaff;
  --good:#33cc44;--bad:#ff3333;
  --shadow:0 8px 48px rgba(255,180,0,.07);
  --hg:linear-gradient(150deg,#0e0028 0%,#001018 55%,#0e0012 100%);
}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'Noto Serif Bengali',serif;min-height:100vh;display:flex;flex-direction:column;transition:background .35s,color .35s}
/* HEADER */
.hdr{background:var(--hg);padding:1.5rem 1rem 1rem;text-align:center;border-bottom:2px solid var(--accent);box-shadow:var(--shadow);position:relative;overflow:hidden}
.hdr::after{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% -20%,rgba(212,160,48,.22),transparent 65%);pointer-events:none}
.hdr .sri{display:block;font-size:.72rem;letter-spacing:.4em;color:var(--accent2);opacity:.6;margin-bottom:.3rem}
.hdr h1{font-size:clamp(1.3rem,5vw,2.3rem);font-weight:900;color:var(--accent2);text-shadow:0 0 28px rgba(240,200,70,.4);line-height:1.2}
.hdr h2{font-size:clamp(.68rem,2vw,.82rem);color:var(--text2);font-weight:300;margin-top:.2rem;letter-spacing:.06em}
/* THEME */
.tbar{background:var(--bg2);display:flex;justify-content:center;gap:.4rem;padding:.42rem;border-bottom:1px solid var(--border);flex-wrap:wrap}
.tb{padding:.25rem .8rem;border:1px solid var(--border);border-radius:20px;background:var(--bg3);color:var(--text2);font-family:inherit;font-size:.72rem;cursor:pointer;transition:all .2s}
.tb.on,.tb:hover{border-color:var(--accent);color:var(--accent);background:var(--card)}
/* NOW BADGE */
.now-badge{background:linear-gradient(90deg,var(--accent3),var(--accent));color:#fff;text-align:center;padding:.32rem .8rem;font-size:.75rem;font-weight:700;letter-spacing:.04em}
/* MAIN */
.main{flex:1;padding:.9rem .9rem 1.5rem;max-width:800px;margin:0 auto;width:100%}
/* SECTION TITLE */
.st{font-size:.88rem;font-weight:700;color:var(--accent2);text-align:center;padding:.5rem .6rem;margin:.9rem 0 .7rem;border-bottom:1px solid var(--border);letter-spacing:.06em}
.st::before,.st::after{content:'‚ú¶';margin:0 .4rem;opacity:.4;font-size:.65rem}
/* CONTROLS */
.ctrl{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:.85rem 1rem;margin-bottom:.9rem;box-shadow:var(--shadow)}
.crow{display:flex;align-items:center;gap:.45rem;margin-bottom:.6rem;flex-wrap:wrap}
.crow:last-child{margin-bottom:0}
.clbl{font-size:.75rem;color:var(--text2);min-width:76px;font-weight:600}
select,input[type=number]{flex:1;background:var(--bg2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:inherit;font-size:.84rem;padding:.4rem .65rem;outline:none;transition:border .2s;min-width:65px}
select:focus,input:focus{border-color:var(--accent)}
.btoday{background:var(--accent);color:#180800;border:none;border-radius:8px;padding:.4rem .9rem;font-family:inherit;font-size:.78rem;font-weight:700;cursor:pointer;transition:background .2s,transform .1s;white-space:nowrap}
.btoday:hover{background:var(--accent2);transform:scale(1.04)}
/* MONTH CALENDAR */
.mcal{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;margin-bottom:.9rem;box-shadow:var(--shadow)}
.mcal-hdr{background:linear-gradient(120deg,var(--accent3) 0%,#180840 100%);padding:.85rem 1rem;display:flex;align-items:center;justify-content:space-between;gap:.4rem}
.mnav{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);color:var(--accent2);border-radius:8px;padding:.3rem .75rem;font-size:.8rem;cursor:pointer;transition:background .18s;font-family:inherit}
.mnav:hover{background:rgba(255,255,255,.22)}
.mcal-title{text-align:center;flex:1}
.mname{font-size:1.6rem;font-weight:900;color:var(--accent2);text-shadow:0 0 18px rgba(240,200,70,.4)}
.myear{font-size:.78rem;color:rgba(255,255,255,.65);margin-top:.12rem}
/* Weekday header */
.wdhdr{display:grid;grid-template-columns:repeat(7,1fr);background:var(--bg3);border-bottom:1px solid var(--border)}
.wdh{text-align:center;padding:.4rem .1rem;font-size:.64rem;font-weight:700;color:var(--text2)}
.wdh:first-child,.wdh:last-child{color:#f05050}
/* Grid */
.cgrid{display:grid;grid-template-columns:repeat(7,1fr);gap:1px;background:var(--border)}
.cc{background:var(--cell);min-height:62px;padding:.3rem .25rem;cursor:pointer;transition:background .15s;position:relative;display:flex;flex-direction:column;gap:2px;overflow:hidden}
.cc:hover{background:var(--bg4)}
.cc.emp{background:var(--bg);cursor:default;opacity:.2}
.cc.tod{background:var(--today-bg);outline:2px solid var(--today-bd);outline-offset:-2px;z-index:2}
.cc.sel{background:var(--sel-bg);outline:2px solid var(--sel-bd);outline-offset:-2px;z-index:3}
.cc.sun .dn,.cc.sat .dn{color:#f05050}
.dn{font-size:.98rem;font-weight:900;color:var(--text);line-height:1}
.den{font-size:.55rem;color:var(--text3);line-height:1;margin-top:1px}
.tod-lbl{font-size:.46rem;background:var(--accent);color:#000;border-radius:3px;padding:0 3px;font-weight:900;position:absolute;top:2px;right:2px}
.fl{font-size:.5rem;color:var(--accent2);line-height:1.25;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;word-break:break-all;margin-top:1px}
.dots{display:flex;gap:2px;flex-wrap:wrap;margin-top:auto}
.dot{width:5px;height:5px;border-radius:50%}
.df{background:var(--fdot)}
.dm{background:var(--mdot)}
/* LEGEND */
.legend{display:flex;gap:.8rem;justify-content:center;padding:.4rem;font-size:.62rem;color:var(--text2);flex-wrap:wrap;border-top:1px solid var(--border);background:var(--bg2)}
.leg{display:flex;align-items:center;gap:.25rem}
.leg .dot{width:7px;height:7px}
/* DAY DETAIL */
.ddet{background:var(--card);border:2px solid var(--accent3);border-radius:16px;margin-bottom:.9rem;overflow:hidden;box-shadow:var(--shadow)}
.ddet-hdr{background:linear-gradient(105deg,var(--accent3),#180840 75%);padding:.8rem 1rem;display:flex;align-items:center;gap:.8rem}
.dbn{font-size:2.8rem;font-weight:900;color:var(--accent2);line-height:1;min-width:62px;text-align:center}
.dinfo{flex:1}
.dwd{font-size:.95rem;font-weight:700;color:#fff}
.dsub{font-size:.68rem;color:rgba(255,255,255,.6);margin-top:.15rem;line-height:1.55}
.dmoon{font-size:1.9rem}
.dbody{padding:.75rem .9rem}
.dr{display:flex;justify-content:space-between;align-items:flex-start;padding:.4rem 0;border-bottom:1px solid var(--border);gap:.4rem}
.dr:last-child{border-bottom:none}
.dk{font-size:.7rem;color:var(--text2);font-weight:600;min-width:105px;padding-top:.05rem}
.dv{font-size:.84rem;color:var(--text);font-weight:700;text-align:right;flex:1}
.gold{color:var(--accent2)}
.purp{color:var(--accent3)}
.red{color:var(--bad)}
.blue{color:var(--accent4)}
.grn{color:var(--good)}
/* Sun boxes */
.sunrow{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-top:.6rem}
.sunbox{background:var(--bg2);border-radius:10px;padding:.5rem;text-align:center;border:1px solid var(--border)}
.si{font-size:1.35rem}
.sl{font-size:.6rem;color:var(--text2);margin-top:.1rem}
.sv{font-size:.85rem;font-weight:700;color:var(--accent2);margin-top:.08rem}
/* Fest in day */
.fbox{margin-top:.65rem;background:linear-gradient(135deg,rgba(212,160,48,.1),rgba(119,68,204,.07));border:1px solid var(--accent);border-radius:10px;padding:.6rem .85rem}
.fbox-t{font-size:.67rem;color:var(--accent2);font-weight:700;margin-bottom:.38rem;letter-spacing:.04em}
.fitem{display:flex;align-items:flex-start;gap:.45rem;padding:.3rem 0;border-bottom:1px solid var(--border)}
.fitem:last-child{border-bottom:none}
.femoji{font-size:1rem;min-width:20px;text-align:center;margin-top:.05rem}
.fname{font-size:.8rem;font-weight:700;color:var(--text)}
.fdesc{font-size:.64rem;color:var(--text2);margin-top:.08rem}
.ftag{font-size:.58rem;padding:.1rem .35rem;border-radius:6px;font-weight:700;white-space:nowrap;margin-left:auto;align-self:flex-start;flex-shrink:0}
/* Upcoming */
.upbox{margin-top:.65rem}
.up-t{font-size:.67rem;color:var(--text2);font-weight:700;margin-bottom:.32rem}
.upitem{display:flex;align-items:center;gap:.45rem;padding:.26rem 0;border-bottom:1px solid var(--border);cursor:pointer}
.upitem:last-child{border-bottom:none}
.upitem:hover .un{color:var(--accent2)}
.ue{font-size:.88rem;min-width:18px}
.un{font-size:.76rem;font-weight:700;color:var(--text);flex:1;transition:color .15s}
.ud{font-size:.62rem;color:var(--text3)}
.uo{font-size:.62rem;font-weight:700;color:var(--accent2);white-space:nowrap}
/* MUHURTAS - ALL 25 for the selected day */
.muh-grid{display:flex;flex-direction:column;gap:.32rem;padding:.75rem}
.muh-item{background:var(--bg2);border:1px solid var(--border);border-radius:10px;padding:.52rem .8rem;display:grid;grid-template-columns:1fr auto;align-items:center;gap:.4rem;transition:border-color .18s,transform .12s}
.muh-item:hover{border-color:var(--accent);transform:translateX(3px)}
.muh-left{}
.muh-name{font-size:.82rem;font-weight:700;color:var(--text)}
.muh-desc{font-size:.64rem;color:var(--text2);margin-top:.1rem}
.muh-time{font-size:.65rem;color:var(--accent2);margin-top:.06rem;font-weight:600}
.mbadge{font-size:.62rem;padding:.14rem .4rem;border-radius:20px;font-weight:700;white-space:nowrap}
.mg{background:rgba(68,187,85,.14);color:var(--good);border:1px solid rgba(68,187,85,.3)}
.mb{background:rgba(238,68,68,.14);color:var(--bad);border:1px solid rgba(238,68,68,.3)}
.mn{background:rgba(255,153,0,.14);color:var(--neutral);border:1px solid rgba(255,153,0,.3)}
/* PANCHANG */
.pgrid{display:grid;grid-template-columns:1fr 1fr;gap:.42rem;padding:.75rem}
.pi{display:flex;flex-direction:column;padding:.5rem .7rem;background:var(--bg2);border-radius:8px;border-left:3px solid var(--accent3)}
.pik{font-size:.62rem;color:var(--text2);margin-bottom:.1rem}
.piv{font-size:.85rem;font-weight:700;color:var(--text)}
/* Vertical date */
.vdt{padding:.65rem .8rem}
.vr{display:grid;grid-template-columns:128px 1fr;padding:.44rem .25rem;border-bottom:1px solid var(--border);align-items:center;gap:.4rem;border-radius:6px;transition:background .14s}
.vr:last-child{border-bottom:none}
.vr:hover{background:var(--bg3)}
.vrk{font-size:.68rem;color:var(--text2);font-weight:600}
.vrv{font-size:.88rem;font-weight:700;color:var(--text)}
/* Festival list */
.fcard{background:var(--card);border:1px solid var(--border);border-radius:16px;overflow:hidden;margin-bottom:.9rem;box-shadow:var(--shadow)}
.fsrch{background:var(--bg2);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:inherit;font-size:.8rem;padding:.4rem .7rem;width:100%;outline:none;transition:border .2s}
.fsrch:focus{border-color:var(--accent)}
.mtabs{display:flex;overflow-x:auto;gap:.28rem;padding:.42rem .55rem;scrollbar-width:none;border-bottom:1px solid var(--border)}
.mtabs::-webkit-scrollbar{display:none}
.mtab{white-space:nowrap;padding:.24rem .58rem;border-radius:20px;border:1px solid var(--border);background:var(--bg2);color:var(--text2);font-family:inherit;font-size:.66rem;cursor:pointer;transition:all .18s}
.mtab.on,.mtab:hover{border-color:var(--accent);color:var(--accent);background:var(--card)}
.fmhdr{background:var(--bg3);padding:.52rem .85rem;display:flex;align-items:center;gap:.48rem;cursor:pointer;user-select:none;border-bottom:1px solid var(--border)}
.fmic{font-size:1.1rem}
.fmn{font-size:.86rem;font-weight:700;color:var(--accent2);flex:1}
.fmc{font-size:.66rem;background:var(--accent3);color:#fff;padding:.1rem .42rem;border-radius:10px}
.fmar{color:var(--text3);transition:transform .24s;font-size:.78rem}
.fmbody{padding:.28rem .5rem .5rem}
.fi{display:grid;grid-template-columns:38px 1fr auto;align-items:center;gap:.45rem;padding:.38rem .25rem;border-bottom:1px solid var(--border);cursor:pointer;border-radius:6px;transition:background .14s}
.fi:last-child{border-bottom:none}
.fi:hover{background:var(--bg3)}
.fidc{text-align:center}
.fid{font-size:.9rem;font-weight:900;color:var(--accent2);line-height:1}
.fie{font-size:.7rem}
.fin{font-size:.8rem;font-weight:700;color:var(--text)}
.fis{font-size:.63rem;color:var(--text2);margin-top:.07rem}
.hidden{display:none}
/* Tags */
.th{background:rgba(255,152,0,.13);color:#ffa726;border:1px solid rgba(255,152,0,.28)}
.tb2{background:rgba(240,200,70,.13);color:#e4b840;border:1px solid rgba(240,200,70,.28)}
.tn{background:rgba(68,187,85,.13);color:#55cc66;border:1px solid rgba(68,187,85,.28)}
.tm{background:rgba(0,195,215,.13);color:#22ccdd;border:1px solid rgba(0,195,215,.28)}
.tc{background:rgba(66,165,245,.13);color:#42a5f5;border:1px solid rgba(66,165,245,.28)}
.tg{background:rgba(140,88,200,.13);color:#9966cc;border:1px solid rgba(140,88,200,.28)}
footer{background:var(--bg2);border-top:1px solid var(--border);text-align:center;padding:.8rem;font-size:.7rem;color:var(--text2);line-height:1.85}
footer em{color:var(--accent);font-style:normal}
@keyframes fup{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}
.mcal,.ddet{animation:fup .32s ease}
</style>
</head>
<body>
<header class="hdr">
  <span class="sri">‡•• ‡¶∂‡ßç‡¶∞‡ßÄ ‡••</span>
  <h1>üåô ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ</h1>
  <h2>‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó ‚Ä¢ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‚Ä¢ ‡¶â‡ßé‡¶∏‡¶¨</h2>
</header>
<div class="tbar">
  <button class="tb on" onclick="setTheme('',this)">üåë ‡¶°‡¶æ‡¶∞‡ßç‡¶ï</button>
  <button class="tb" onclick="setTheme('L',this)">‚òÄÔ∏è ‡¶≤‡¶æ‡¶á‡¶ü</button>
  <button class="tb" onclick="setTheme('O',this)">‚ö´ OLED</button>
  <div style="width:1px;background:var(--border);margin:0 .2rem;align-self:stretch"></div>
  <button class="tb" id="langBtn" onclick="toggleLang()">üî§ English</button>
  <div style="width:1px;background:var(--border);margin:0 .2rem;align-self:stretch"></div>
  <button class="tb" id="regionBtn" onclick="toggleRegion()">üáßüá© BD</button>
</div>
<div class="now-badge" id="nowBadge">‚è∞ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
<main class="main">
<!-- CONTROLS -->
<div class="ctrl">
  <div class="crow">
    <span class="clbl">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶∏‡¶æ‡¶≤</span>
    <button class="mnav" onclick="shiftY(-1)" style="padding:.3rem .6rem">‚óÄ</button>
    <input type="number" id="inYear" min="-1000000" max="1000000"/>
    <button class="mnav" onclick="shiftY(1)" style="padding:.3rem .6rem">‚ñ∂</button>
    <button class="btoday" onclick="goToday()">üìÖ <span class="lt" data-bn="‡¶Ü‡¶ú" data-en="Today">‡¶Ü‡¶ú</span></button>
    <button class="btoday" onclick="resetAll()" style="background:var(--bg3);color:var(--text2);border:1px solid var(--border)" title="‡¶∏‡¶¨ ‡¶™‡¶∞‡¶ø‡¶∑‡ßç‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®">üîÑ</button>
  </div>
  <div class="crow">
    <span class="clbl">‡¶Æ‡¶æ‡¶∏</span>
    <select id="inMonth">
      <option value="0">‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ</option><option value="1">‡¶ú‡ßç‡¶Ø‡ßà‡¶∑‡ßç‡¶†</option>
      <option value="2">‡¶Ü‡¶∑‡¶æ‡¶¢‡¶º</option><option value="3">‡¶∂‡ßç‡¶∞‡¶æ‡¶¨‡¶£</option>
      <option value="4">‡¶≠‡¶æ‡¶¶‡ßç‡¶∞</option><option value="5">‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶®</option>
      <option value="6">‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï</option><option value="7">‡¶Ö‡¶ó‡ßç‡¶∞‡¶π‡¶æ‡¶Ø‡¶º‡¶£</option>
      <option value="8">‡¶™‡ßå‡¶∑</option><option value="9">‡¶Æ‡¶æ‡¶ò</option>
      <option value="10">‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶®</option><option value="11">‡¶ö‡ßà‡¶§‡ßç‡¶∞</option>
    </select>
  </div>
</div>
<!-- MONTH CALENDAR -->
<div class="mcal" id="mcal">
  <div class="mcal-hdr">
    <button class="mnav" onclick="shiftM(-1)">‚óÄ</button>
    <div class="mcal-title">
      <div class="mname" id="mname"></div>
      <div class="myear" id="myear"></div>
    </div>
    <button class="mnav" onclick="shiftM(1)">‚ñ∂</button>
  </div>
  <div class="wdhdr" id="wdhdr">
    <div class="wdh">‡¶∞‡¶¨‡¶ø</div><div class="wdh">‡¶∏‡ßã‡¶Æ</div><div class="wdh">‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤</div>
    <div class="wdh">‡¶¨‡ßÅ‡¶ß</div><div class="wdh">‡¶¨‡ßÉ‡¶π‡¶É</div><div class="wdh">‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞</div><div class="wdh">‡¶∂‡¶®‡¶ø</div>
  </div>
  <div class="cgrid" id="cgrid"></div>
  <div class="legend">
    <div class="leg"><div class="dot dm"></div>‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ/‡¶Ö‡¶Æ‡¶æ‡¶¨‡¶∏‡ßç‡¶Ø‡¶æ</div>
    <div class="leg"><div class="dot df"></div>‡¶â‡ßé‡¶∏‡¶¨</div>
    <div class="leg" style="color:var(--today-bd)">‚ñ† ‡¶Ü‡¶ú</div>
    <div class="leg" style="color:var(--sel-bd)">‚ñ† ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§</div>
  </div>
</div>
<!-- DAY DETAIL -->
<div class="mcal" style="margin-bottom:.9rem">
  <div class="mcal-hdr" onclick="toggleDayDet()" style="cursor:pointer;user-select:none;padding:.72rem 1rem;display:flex;align-items:center;justify-content:space-between">
    <div style="font-size:.88rem;font-weight:700;color:var(--accent2);letter-spacing:.05em">‚ú¶ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£ ‚ú¶</div>
    <span id="dayDetArrow" style="color:var(--accent2);font-size:.82rem;transition:transform .25s;display:inline-block">‚ñº</span>
  </div>
  <div id="dayDetBody" class="hidden">
    <div class="ddet" id="ddet"></div>
  </div>
</div>
<!-- PANCHANG -->
<div class="mcal" id="panchaCard" style="margin-bottom:.9rem">
  <div class="mcal-hdr" onclick="togglePanch()" style="cursor:pointer;user-select:none;padding:.65rem 1rem;display:flex;align-items:center;justify-content:space-between">
    <div class="mcal-title"><div style="font-size:.85rem;font-weight:700;color:var(--accent2)" id="ptitle">‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó</div></div>
    <span id="panchArrow" style="color:var(--accent2);font-size:.82rem;transition:transform .25s;display:inline-block">‚ñº</span>
  </div>
  <div id="panchBody" class="hidden">
    <div class="pgrid" id="pgrid"></div>
    <div style="border-top:1px solid var(--border)"><div class="vdt" id="vdt"></div></div>
  </div>
</div>
<!-- MUHURTAS FOR SELECTED DAY -->
<div class="mcal" style="margin-bottom:.9rem">
  <div class="mcal-hdr" onclick="toggleMuh()" style="cursor:pointer;user-select:none;padding:.72rem 1rem;display:flex;align-items:center;justify-content:space-between">
    <div style="font-size:.88rem;font-weight:700;color:var(--accent2);letter-spacing:.05em">‚ú¶ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‚ú¶</div>
    <span id="muhArrow" style="color:var(--accent2);font-size:.82rem;transition:transform .25s;display:inline-block">‚ñº</span>
  </div>
  <div id="muhBody" class="hidden">
    <div class="muh-grid" id="muhGrid"></div>
  </div>
</div>
<!-- FESTIVALS -->
<div class="fcard">
  <div class="mcal-hdr" onclick="toggleFest()" style="cursor:pointer;user-select:none;padding:.72rem 1rem;display:flex;align-items:center;justify-content:space-between">
    <div style="font-size:.88rem;font-weight:700;color:var(--accent2);letter-spacing:.05em">‚ú¶ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶â‡ßé‡¶∏‡¶¨ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‚ú¶</div>
    <span id="festArrow" style="color:var(--accent2);font-size:.82rem;transition:transform .25s;display:inline-block">‚ñº</span>
  </div>
  <div id="festBody" class="hidden">
    <div style="padding:.65rem .75rem .28rem">
      <input class="fsrch" id="fsrch" placeholder="üîç ‡¶â‡ßé‡¶∏‡¶¨ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®..." oninput="filterF(this.value)"/>
    </div>
    <div class="mtabs" id="mtabs"></div>
    <div id="fcont"></div>
  </div>
</div>
</main>
<footer>
  <div>¬© <em>‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï ‡¶∞‡¶æ‡¶Ø‡¶º</em> <em id="fy1">2026</em> ‚Ä¢ ‡¶∏‡¶∞‡ßç‡¶¨‡¶∏‡ßç‡¶¨‡¶§‡ßç‡¶¨ ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§‡•§</div>
  <div>¬© <em>Manik Roy</em> <em id="fy2">2026</em>. All Rights Reserved.</div>
  <div style="opacity:.38;font-size:.62rem;margin-top:.25rem">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‚Ä¢ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶ú‡ßç‡¶Ø‡ßã‡¶§‡¶ø‡¶∞‡ßç‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ ‡¶ó‡¶£‡¶®‡¶æ</div>
</footer>

<script>
'use strict';
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   BENGALI DIGITS & CONSTANTS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
/* ‚îÄ‚îÄ LANGUAGE STATE ‚îÄ‚îÄ */
let LANG = 'bn'; // 'bn' or 'en'
let REGION = 'BD'; // 'BD' or 'WB'

/* ‚îÄ‚îÄ LANGUAGE & REGION STATE ‚îÄ‚îÄ */
let LANG = 'bn';   // 'bn' | 'en'
let REGION = 'BD'; // 'BD' | 'WB'

const BD = ['‡ß¶','‡ßß','‡ß®','‡ß©','‡ß™','‡ß´','‡ß¨','‡ß≠','‡ßÆ','‡ßØ'];
function bn(n){
  const neg = n < 0;
  const s = Math.abs(Math.round(n)).toString();
  if (LANG === 'en') return (neg ? '-' : '') + s;
  return (neg ? '-' : '') + s.split('').map(c => BD[+c]).join('');
}
function bnf(n, dec=0){
  const neg = n < 0;
  const fixed = Math.abs(n).toFixed(dec);
  if (LANG === 'en') return (neg ? '-' : '') + fixed;
  return (neg ? '-' : '') + fixed.replace(/[0-9]/g, d => BD[+d]);
}
// Language-aware text: returns bn or en string
function lt(bn_text, en_text){ return LANG === 'en' ? en_text : bn_text; }

const BN_M  = ['‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ','‡¶ú‡ßç‡¶Ø‡ßà‡¶∑‡ßç‡¶†','‡¶Ü‡¶∑‡¶æ‡¶¢‡¶º','‡¶∂‡ßç‡¶∞‡¶æ‡¶¨‡¶£','‡¶≠‡¶æ‡¶¶‡ßç‡¶∞','‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶®','‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï','‡¶Ö‡¶ó‡ßç‡¶∞‡¶π‡¶æ‡¶Ø‡¶º‡¶£','‡¶™‡ßå‡¶∑','‡¶Æ‡¶æ‡¶ò','‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶®','‡¶ö‡ßà‡¶§‡ßç‡¶∞'];
// Official Bengali calendar day counts (Government of West Bengal / Bangladesh)
// Baishakh-Bhadra: 31 days; Ashwin-Chaitra: 30 days
// Leap year: Falgun = 31 days (Gregorian leap year rule)
const BN_MD_NORM = [31,31,31,31,31,30,30,30,30,30,30,30];
const BN_MD_LEAP = [31,31,31,31,31,30,30,30,30,30,31,30];

const BN_WD = ['‡¶∞‡¶¨‡¶ø‡¶¨‡¶æ‡¶∞','‡¶∏‡ßã‡¶Æ‡¶¨‡¶æ‡¶∞','‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤‡¶¨‡¶æ‡¶∞','‡¶¨‡ßÅ‡¶ß‡¶¨‡¶æ‡¶∞','‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø‡¶¨‡¶æ‡¶∞','‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞','‡¶∂‡¶®‡¶ø‡¶¨‡¶æ‡¶∞'];
const BN_WD_S = ['‡¶∞‡¶¨‡¶ø','‡¶∏‡ßã‡¶Æ','‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤','‡¶¨‡ßÅ‡¶ß','‡¶¨‡ßÉ‡¶π‡¶É','‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞','‡¶∂‡¶®‡¶ø'];
const ENG_M  = ['January','February','March','April','May','June','July','August','September','October','November','December'];
const EN_BN_M = ['Baishakh','Jyaistha','Ashadh','Shraban','Bhadra','Ashwin','Kartik','Agrahayan','Paush','Magh','Falgun','Chaitra'];
const EN_WD  = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'];
const EN_WD_S= ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const EN_TITHIS = [
  'Pratipada','Dvitiya','Tritiya','Chaturthi','Panchami','Shashthi','Saptami',
  'Ashtami','Navami','Dashami','Ekadashi','Dvadashi','Trayodashi','Chaturdashi','Purnima',
  'Pratipada','Dvitiya','Tritiya','Chaturthi','Panchami','Shashthi','Saptami',
  'Ashtami','Navami','Dashami','Ekadashi','Dvadashi','Trayodashi','Chaturdashi','Amavasya'
];
const EN_NAKSH = ['Ashvini','Bharani','Krittika','Rohini','Mrigashira','Ardra','Punarvasu','Pushya','Ashlesha','Magha','Purva Phalguni','Uttara Phalguni','Hasta','Chitra','Swati','Vishakha','Anuradha','Jyeshtha','Mula','Purva Ashadha','Uttara Ashadha','Shravana','Dhanishtha','Shatabhisha','Purva Bhadrapada','Uttara Bhadrapada','Revati'];
const EN_YOGAS = ['Vishkambha','Priti','Ayushman','Saubhagya','Shobhana','Atiganda','Sukarma','Dhriti','Shula','Ganda','Vriddhi','Dhruva','Vyaghata','Harshana','Vajra','Siddhi','Vyatipata','Variyan','Parigha','Shiva','Siddha','Sadhya','Shubha','Shukla','Brahma','Indra','Vaidhriti'];
const EN_RITUS = ['Summer','Monsoon','Autumn','Pre-Winter','Winter','Spring'];
const EN_HI_M = ['Muharram','Safar','Rabi al-Awwal','Rabi al-Thani','Jumada al-Awwal','Jumada al-Thani','Rajab','Shaban','Ramadan','Shawwal','Dhu al-Qadah','Dhu al-Hijjah'];
const HI_M   = ['‡¶Æ‡ßÅ‡¶π‡¶∞‡¶∞‡¶Æ','‡¶∏‡¶´‡¶∞','‡¶∞‡¶¨‡¶ø‡¶â‡¶≤ ‡¶Ü‡¶â‡¶Ø‡¶º‡¶æ‡¶≤','‡¶∞‡¶¨‡¶ø‡¶â‡¶∏ ‡¶∏‡¶æ‡¶®‡¶ø','‡¶ú‡¶Æ‡¶æ‡¶¶‡¶ø‡¶â‡¶≤ ‡¶Ü‡¶â‡¶Ø‡¶º‡¶æ‡¶≤','‡¶ú‡¶Æ‡¶æ‡¶¶‡¶ø‡¶â‡¶∏ ‡¶∏‡¶æ‡¶®‡¶ø','‡¶∞‡¶ú‡¶¨','‡¶∂‡¶æ‡¶¨‡¶æ‡¶®','‡¶∞‡¶Æ‡¶ú‡¶æ‡¶®','‡¶∂‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤','‡¶ú‡¶ø‡¶≤‡¶ï‡¶¶','‡¶ú‡¶ø‡¶≤‡¶π‡¶ú'];
const RASHIS    = ['‡¶Æ‡ßá‡¶∑','‡¶¨‡ßÉ‡¶∑','‡¶Æ‡¶ø‡¶•‡ßÅ‡¶®','‡¶ï‡¶∞‡ßç‡¶ï‡¶ü','‡¶∏‡¶ø‡¶Ç‡¶π','‡¶ï‡¶®‡ßç‡¶Ø‡¶æ','‡¶§‡ßÅ‡¶≤‡¶æ','‡¶¨‡ßÉ‡¶∂‡ßç‡¶ö‡¶ø‡¶ï','‡¶ß‡¶®‡ßÅ','‡¶Æ‡¶ï‡¶∞','‡¶ï‡ßÅ‡¶Æ‡ßç‡¶≠','‡¶Æ‡ßÄ‡¶®'];
const EN_RASHIS = ['Aries','Taurus','Gemini','Cancer','Leo','Virgo','Libra','Scorpio','Sagittarius','Capricorn','Aquarius','Pisces'];


const TITHIS_30 = [
  '‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶¶','‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ','‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ','‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ','‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ','‡¶∑‡¶∑‡ßç‡¶†‡ßÄ','‡¶∏‡¶™‡ßç‡¶§‡¶Æ‡ßÄ',
  '‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ','‡¶®‡¶¨‡¶Æ‡ßÄ','‡¶¶‡¶∂‡¶Æ‡ßÄ','‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ','‡¶¶‡ßç‡¶¨‡¶æ‡¶¶‡¶∂‡ßÄ','‡¶§‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶¶‡¶∂‡ßÄ','‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶¶‡¶∂‡ßÄ','‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ',
  '‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶™‡¶¶','‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ','‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ','‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ','‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ','‡¶∑‡¶∑‡ßç‡¶†‡ßÄ','‡¶∏‡¶™‡ßç‡¶§‡¶Æ‡ßÄ',
  '‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ','‡¶®‡¶¨‡¶Æ‡ßÄ','‡¶¶‡¶∂‡¶Æ‡ßÄ','‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ','‡¶¶‡ßç‡¶¨‡¶æ‡¶¶‡¶∂‡ßÄ','‡¶§‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶¶‡¶∂‡ßÄ','‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶¶‡¶∂‡ßÄ','‡¶Ö‡¶Æ‡¶æ‡¶¨‡¶∏‡ßç‡¶Ø‡¶æ'
];
const PAKSHA = ['‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑ (‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑)','‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ (‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑)'];
const NAKSH  = ['‡¶Ö‡¶∂‡ßç‡¶¨‡¶ø‡¶®‡ßÄ','‡¶≠‡¶∞‡¶£‡ßÄ','‡¶ï‡ßÉ‡¶§‡ßç‡¶§‡¶ø‡¶ï‡¶æ','‡¶∞‡ßã‡¶π‡¶ø‡¶£‡ßÄ','‡¶Æ‡ßÉ‡¶ó‡¶∂‡¶ø‡¶∞‡¶æ','‡¶Ü‡¶∞‡ßç‡¶¶‡ßç‡¶∞‡¶æ','‡¶™‡ßÅ‡¶®‡¶∞‡ßç‡¶¨‡¶∏‡ßÅ','‡¶™‡ßÅ‡¶∑‡ßç‡¶Ø‡¶æ','‡¶Ü‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶æ','‡¶Æ‡¶ò‡¶æ','‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶®‡ßÄ','‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶®‡ßÄ','‡¶π‡¶∏‡ßç‡¶§‡¶æ','‡¶ö‡¶ø‡¶§‡ßç‡¶∞‡¶æ','‡¶∏‡ßç‡¶¨‡¶æ‡¶§‡ßÄ','‡¶¨‡¶ø‡¶∂‡¶æ‡¶ñ‡¶æ','‡¶Ö‡¶®‡ßÅ‡¶∞‡¶æ‡¶ß‡¶æ','‡¶ú‡ßç‡¶Ø‡ßá‡¶∑‡ßç‡¶†‡¶æ','‡¶Æ‡ßÇ‡¶≤‡¶æ','‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶æ‡¶∑‡¶æ‡¶¢‡¶º‡¶æ','‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶æ‡¶∑‡¶æ‡¶¢‡¶º‡¶æ','‡¶∂‡ßç‡¶∞‡¶¨‡¶£‡¶æ','‡¶ß‡¶®‡¶ø‡¶∑‡ßç‡¶†‡¶æ','‡¶∂‡¶§‡¶≠‡¶ø‡¶∑‡¶æ','‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶≠‡¶æ‡¶¶‡ßç‡¶∞‡¶™‡¶¶','‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶≠‡¶æ‡¶¶‡ßç‡¶∞‡¶™‡¶¶','‡¶∞‡ßá‡¶¨‡¶§‡ßÄ'];
const YOGAS  = ['‡¶¨‡¶ø‡¶∑‡ßç‡¶ï‡¶Æ‡ßç‡¶≠','‡¶™‡ßç‡¶∞‡ßÄ‡¶§‡¶ø','‡¶Ü‡¶Ø‡¶º‡ßÅ‡¶∑‡ßç‡¶Æ‡¶æ‡¶®','‡¶∏‡ßå‡¶≠‡¶æ‡¶ó‡ßç‡¶Ø','‡¶∂‡ßã‡¶≠‡¶®','‡¶Ö‡¶§‡¶ø‡¶ó‡¶£‡ßç‡¶°','‡¶∏‡ßÅ‡¶ï‡¶∞‡ßç‡¶Æ‡¶æ','‡¶ß‡ßÉ‡¶§‡¶ø','‡¶∂‡ßÇ‡¶≤','‡¶ó‡¶£‡ßç‡¶°','‡¶¨‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø','‡¶ß‡ßç‡¶∞‡ßÅ‡¶¨','‡¶¨‡ßç‡¶Ø‡¶æ‡¶ò‡¶æ‡¶§','‡¶π‡¶∞‡ßç‡¶∑‡¶£','‡¶¨‡¶ú‡ßç‡¶∞','‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶ø','‡¶¨‡ßç‡¶Ø‡¶§‡ßÄ‡¶™‡¶æ‡¶§','‡¶¨‡¶∞‡ßÄ‡¶Ø‡¶º‡¶æ‡¶®','‡¶™‡¶∞‡¶ø‡¶ò','‡¶∂‡¶ø‡¶¨','‡¶∏‡¶ø‡¶¶‡ßç‡¶ß','‡¶∏‡¶æ‡¶ß‡ßç‡¶Ø','‡¶∂‡ßÅ‡¶≠','‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤','‡¶¨‡ßç‡¶∞‡¶π‡ßç‡¶Æ','‡¶á‡¶®‡ßç‡¶¶‡ßç‡¶∞','‡¶¨‡ßà‡¶ß‡ßÉ‡¶§‡¶ø'];
const KARANAS= ['‡¶¨‡¶¨','‡¶¨‡¶æ‡¶≤‡¶¨','‡¶ï‡ßå‡¶≤‡¶¨','‡¶§‡ßà‡¶§‡¶ø‡¶≤','‡¶ó‡¶∞','‡¶¨‡¶£‡¶ø‡¶ú','‡¶¨‡¶ø‡¶∑‡ßç‡¶ü‡¶ø','‡¶∂‡¶ï‡ßÅ‡¶®‡¶ø','‡¶ö‡¶§‡ßÅ‡¶∑‡ßç‡¶™‡¶¶','‡¶®‡¶æ‡¶ó','‡¶ï‡¶ø‡¶Ç‡¶∏‡ßç‡¶§‡ßÅ‡¶ò‡ßç‡¶®'];
const RITUS  = ['‡¶ó‡ßç‡¶∞‡ßÄ‡¶∑‡ßç‡¶Æ','‡¶¨‡¶∞‡ßç‡¶∑‡¶æ','‡¶∂‡¶∞‡ßé','‡¶π‡ßá‡¶Æ‡¶®‡ßç‡¶§','‡¶∂‡ßÄ‡¶§','‡¶¨‡¶∏‡¶®‡ßç‡¶§'];
const MOON_P = ['üåë','üåí','üåì','üåî','üåï','üåñ','üåó','üåò'];
const M_ICO  = ['üå∏','‚òÄÔ∏è','üåßÔ∏è','üåø','üåæ','üå∫','ü™î','üåæ','‚ùÑÔ∏è','üìö','üå∑','üéã'];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ACCURATE JULIAN DAY NUMBER (Gregorian ‚Üî JD)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function gregorianToJD(y, m, d) {
  // m = 1..12
  const A = Math.floor((14 - m) / 12);
  const Y = y + 4800 - A;
  const M = m + 12 * A - 3;
  return d + Math.floor((153 * M + 2) / 5) + 365 * Y +
         Math.floor(Y / 4) - Math.floor(Y / 100) +
         Math.floor(Y / 400) - 32045;
}

function jdToGregorian(jd) {
  const a = jd + 32044;
  const b = Math.floor((4 * a + 3) / 146097);
  const c = a - Math.floor((146097 * b) / 4);
  const d = Math.floor((4 * c + 3) / 1461);
  const e = c - Math.floor((1461 * d) / 4);
  const m = Math.floor((5 * e + 2) / 153);
  const day = e - Math.floor((153 * m + 2) / 5) + 1;
  const month = m + 3 - 12 * Math.floor(m / 10); // 1..12
  const year = 100 * b + d - 4800 + Math.floor(m / 10);
  return { y: year, m: month, d: day };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   BENGALI CALENDAR CONVERSIONS
   Reference epoch: 1 Baishakh 1 BS = 14 April 594 CE (Julian) 
   Modern Bangla calendar (revised Bangabda) aligns:
   1 Baishakh = 14 April (15 April in Gregorian leap years from 1901)
   Bangladesh officially: 14 April always.
   West Bengal: 14 or 15 April.
   We use the standard: 1 Baishakh BS = 14 April CE (Gregorian)
   BS year = CE year - 593 (before 14 April) or CE year - 593 (from 14 April)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function isGregorianLeap(y) {
  return (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0;
}
function isBSLeap(bsYear) {
  // Bengali leap year follows the Gregorian year that starts that BS year
  // BS year N starts in CE year N+593
  // If CE year (N+594) is leap => Falgun of that BS year has 31 days
  return isGregorianLeap(bsYear + 594);
}
function getBSMonthDays(bsYear, bsMonth) {
  const md = isBSLeap(bsYear) ? BN_MD_LEAP : BN_MD_NORM;
  return md[bsMonth];
}

// Gregorian date ‚Üí Bengali date
// Uses: 1 Baishakh = 14 April each Gregorian year
function gregorianToBengali(gy, gm, gd) {
  // JD of given Gregorian date
  const jd = gregorianToJD(gy, gm, gd);
  // JD of 1 Baishakh of the BS year that probably contains this date
  // Try BS year = gy - 593
  let bsYear = gy - 593;
  let jdBaishakh1 = gregorianToJD(gy, 4, 14); // 14 April of CE year
  if (jd < jdBaishakh1) {
    bsYear = gy - 594;
    jdBaishakh1 = gregorianToJD(gy - 1, 4, 14);
  }
  // Day offset from 1 Baishakh
  let dayOffset = jd - jdBaishakh1; // 0-based
  const md = isBSLeap(bsYear) ? BN_MD_LEAP : BN_MD_NORM;
  let bsMonth = 0;
  while (bsMonth < 11 && dayOffset >= md[bsMonth]) {
    dayOffset -= md[bsMonth];
    bsMonth++;
  }
  const bsDay = dayOffset + 1;
  return { y: bsYear, m: bsMonth, d: bsDay };
}

// Bengali date ‚Üí Gregorian date
function bengaliToGregorian(bsYear, bsMonth, bsDay) {
  const ceYear = bsYear + 593;
  // JD of 1 Baishakh of this BS year = 14 April of CE year ceYear
  const jdBaishakh1 = gregorianToJD(ceYear, 4, 14);
  // Days from 1 Baishakh
  const md = isBSLeap(bsYear) ? BN_MD_LEAP : BN_MD_NORM;
  let daysOffset = 0;
  for (let i = 0; i < bsMonth; i++) daysOffset += md[i];
  daysOffset += bsDay - 1;
  const jd = jdBaishakh1 + daysOffset;
  const g = jdToGregorian(jd);
  return { y: g.y, m: g.m, d: g.d, jd: jd };
}

function bengaliToDate(bsY, bsM, bsD) {
  const g = bengaliToGregorian(bsY, bsM, bsD);
  return new Date(g.y, g.m - 1, g.d);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ACCURATE ASTRONOMICAL CALCULATIONS
   Based on Jean Meeus "Astronomical Algorithms" 2nd ed.
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const DEG = Math.PI / 180;
const RAD = 180 / Math.PI;

function jdToT(jd) { return (jd - 2451545.0) / 36525.0; }

// Sun's apparent longitude (degrees) - Meeus Ch.25
function sunLongitude(jd) {
  const T = jdToT(jd);
  const T2 = T * T; const T3 = T2 * T;
  // Geometric mean longitude
  let L0 = 280.46646 + 36000.76983 * T + 0.0003032 * T2;
  L0 = ((L0 % 360) + 360) % 360;
  // Mean anomaly
  let M = 357.52911 + 35999.05029 * T - 0.0001537 * T2;
  M = ((M % 360) + 360) % 360;
  const Mrad = M * DEG;
  // Equation of centre
  const C = (1.914602 - 0.004817 * T - 0.000014 * T2) * Math.sin(Mrad)
           + (0.019993 - 0.000101 * T) * Math.sin(2 * Mrad)
           + 0.000289 * Math.sin(3 * Mrad);
  const sunLon = L0 + C;
  // Apparent longitude (nutation correction simplified)
  const omega = 125.04 - 1934.136 * T;
  const apparent = sunLon - 0.00569 - 0.00478 * Math.sin(omega * DEG);
  return ((apparent % 360) + 360) % 360;
}

// Moon's longitude (degrees) - Meeus Ch.47 simplified
function moonLongitude(jd) {
  const T = jdToT(jd);
  const T2 = T * T; const T3 = T2 * T; const T4 = T3 * T;
  // Moon's mean longitude
  let Lp = 218.3164477 + 481267.88123421 * T - 0.0015786 * T2 + T3 / 538841 - T4 / 65194000;
  Lp = ((Lp % 360) + 360) % 360;
  // Mean elongation
  let D = 297.8501921 + 445267.1114034 * T - 0.0018819 * T2 + T3 / 545868 - T4 / 113065000;
  D = ((D % 360) + 360) % 360;
  // Sun's mean anomaly
  let M = 357.5291092 + 35999.0502909 * T - 0.0001536 * T2 + T3 / 24490000;
  M = ((M % 360) + 360) % 360;
  // Moon's mean anomaly
  let Mp = 134.9633964 + 477198.8675055 * T + 0.0087414 * T2 + T3 / 69699 - T4 / 14712000;
  Mp = ((Mp % 360) + 360) % 360;
  // Moon's arg of latitude
  let F = 93.2720950 + 483202.0175233 * T - 0.0036539 * T2 - T3 / 3526000 + T4 / 863310000;
  F = ((F % 360) + 360) % 360;

  const r = DEG;
  // Longitude corrections (major terms from Meeus Table 47-A)
  let dL = 6288774 * Math.sin(Mp * r)
           + 1274027 * Math.sin((2*D - Mp) * r)
           + 658314  * Math.sin(2*D * r)
           + 213618  * Math.sin(2*Mp * r)
           - 185116  * Math.sin(M * r)
           - 114332  * Math.sin(2*F * r)
           + 58793   * Math.sin((2*D - 2*Mp) * r)
           + 57066   * Math.sin((2*D - M - Mp) * r)
           + 53322   * Math.sin((2*D + Mp) * r)
           + 45758   * Math.sin((2*D - M) * r)
           - 40923   * Math.sin((M - Mp) * r)
           - 34720   * Math.sin(D * r)
           - 30383   * Math.sin((M + Mp) * r)
           + 15327   * Math.sin((2*D - 2*F) * r)
           - 12528   * Math.sin(Mp + 2*F * r)
           + 10980   * Math.sin((Mp - 2*F) * r)
           + 10675   * Math.sin((4*D - Mp) * r)
           + 10034   * Math.sin(3*Mp * r)
           + 8548    * Math.sin((4*D - 2*Mp) * r)
           - 7888    * Math.sin((2*D + M - Mp) * r)
           - 6766    * Math.sin((2*D + M) * r)
           - 5163    * Math.sin((D - Mp) * r);
  // dL is in 0.000001 degrees
  let moonLon = Lp + dL / 1000000.0;
  moonLon = ((moonLon % 360) + 360) % 360;
  return moonLon;
}

// Tithi: based on elongation of moon from sun
// Each tithi = 12¬∞ of elongation
function calcTithi(jd) {
  const slon = sunLongitude(jd);
  const mlon = moonLongitude(jd);
  let elong = mlon - slon;
  elong = ((elong % 360) + 360) % 360;
  const tithiNum = Math.floor(elong / 12); // 0..29
  const tithiFrac = (elong % 12) / 12;
  return { num: tithiNum, frac: tithiFrac, elong: elong, slon: slon, mlon: mlon };
}

// Nakshatra: Moon's longitude / (360/27)
function calcNakshatra(jd) {
  const mlon = moonLongitude(jd);
  const idx = Math.floor(mlon / (360 / 27)) % 27;
  const frac = (mlon % (360 / 27)) / (360 / 27);
  return { idx, name: NAKSH[idx], frac, lon: mlon };
}

// Yoga: (Sun lon + Moon lon) / (360/27)
function calcYoga(jd) {
  const slon = sunLongitude(jd);
  const mlon = moonLongitude(jd);
  const sum = ((slon + mlon) % 360 + 360) % 360;
  const idx = Math.floor(sum / (360 / 27)) % 27;
  return { idx, name: YOGAS[idx] };
}

// Karana: half-tithi (each tithi has 2 karanas)
function calcKarana(jd) {
  const t = calcTithi(jd);
  // Karana number (0..59), first 4 fixed, rest cyclic
  const karanaNum = Math.floor(t.elong / 6); // 0-59
  let karanaIdx;
  if (karanaNum === 0) karanaIdx = 10; // Kimstughna
  else if (karanaNum >= 57) {
    const fix = [7,8,9,10]; // Shakuni,Chatushpada,Naga,Kimstughna
    karanaIdx = fix[karanaNum - 57];
  } else {
    karanaIdx = ((karanaNum - 1) % 7);
  }
  return { idx: karanaIdx, name: KARANAS[Math.max(0,Math.min(10,karanaIdx))] };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ACCURATE SUNRISE / SUNSET (Meeus Ch.15)
   Using coordinates for Dhaka: 23.7¬∞N, 90.4¬∞E
   (centred for Bangladesh + West Bengal)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const LAT = 23.7; // degrees N
const LON = 90.4; // degrees E
const TZ  = 6.0;  // UTC+6 (IST = 5.5, but we use 6 for BD; user can adjust)

function sunRiseSet(jd) {
  // Approximate sunrise/sunset using equation of time
  const T = jdToT(jd);
  // Solar declination
  const epsilon = 23.439292 - 0.013004 * T; // obliquity
  const slon = sunLongitude(jd);
  const sinDec = Math.sin(epsilon * DEG) * Math.sin(slon * DEG);
  const dec = Math.asin(sinDec) * RAD; // degrees

  // Hour angle for sunrise/sunset (h = -0.8333 standard refraction+disc)
  const cosHA = (Math.sin(-0.8333 * DEG) - Math.sin(LAT * DEG) * Math.sin(dec * DEG))
                / (Math.cos(LAT * DEG) * Math.cos(dec * DEG));

  if (cosHA > 1) return { rise: null, set: null }; // polar night
  if (cosHA < -1) return { rise: null, set: null }; // midnight sun

  const HA = Math.acos(cosHA) * RAD; // degrees

  // Equation of time (minutes) - simplified
  const L0rad = ((280.46646 + 36000.76983 * T) % 360) * DEG;
  const Mrad  = ((357.52911 + 35999.05029 * T) % 360) * DEG;
  const eot   = (-7.655 * Math.sin(Mrad) + 9.873 * Math.sin(2 * L0rad + 3.588 * DEG)
                + 0.439 * Math.sin(4 * L0rad)) / 60; // hours

  // Transit time (solar noon) in local time
  const transit = 12 - LON / 15 + TZ - eot;
  const riseH = transit - HA / 15;
  const setH  = transit + HA / 15;

  function toHHMM(h) {
    const hh = Math.floor(((h % 24) + 24) % 24);
    const mm = Math.round((((h % 24) + 24) % 24 - hh) * 60);
    const mm2 = mm === 60 ? 0 : mm;
    const hh2 = mm === 60 ? hh + 1 : hh;
    return bn(hh2) + ':' + (mm2 < 10 ? '‡ß¶' + bn(mm2) : bn(mm2));
  }
  return { rise: toHHMM(riseH), set: toHHMM(setH), riseH, setH, transit };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   HIJRI CONVERSION (Accurate tabular method)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function gregorianToHijri(gy, gm, gd) {
  const jd = gregorianToJD(gy, gm, gd);
  // Islamic calendar epoch: 1 Muharram 1 AH = 16 July 622 CE = JD 1948439.5
  // We use integer JD aligned to noon
  const N = jd - 1948438;
  const year  = Math.floor((11 * N + 3) / 325) + 1;
  const month = Math.floor((11 * (N - Math.floor((11 * (year - 1) * 30 + 3) / 325 + 1) * 30 - Math.floor((year - 1) / 30) * 11 + 6) + 11) / 325) + 1;
  // Simpler reliable formula:
  let L = jd - 1948439 + 10632;
  const N2 = Math.floor((L - 1) / 10631);
  L = L - 10631 * N2 + 354;
  const J = Math.floor((10985 - L) / 5316) * Math.floor((50 * L) / 17719)
           + Math.floor(L / 5670) * Math.floor((43 * L) / 15238);
  L = L - Math.floor((30 - J) / 15) * Math.floor((17719 * J) / 50)
        - Math.floor(J / 16) * Math.floor((15238 * J) / 43) + 29;
  const Hm = Math.floor((24 * L) / 709);
  const Hd = L - Math.floor((709 * Hm) / 24);
  const Hy = 30 * N2 + J - 30;
  return { y: Hy, m: Math.max(1, Math.min(12, Hm)), d: Hd };
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ACCURATE 25 MUHURTAS FOR A GIVEN DAY
   Each day has 30 muhurtas (15 day + 15 night).
   Day muhurtas: from sunrise to sunset (divided into 15 equal parts).
   Night muhurtas: from sunset to next sunrise (15 parts).
   The 25 classical named muhurtas cycle through the day.
   We compute real sunrise/sunset and divide accordingly.
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const MUH_NAMES = [
  '‡¶∞‡ßÅ‡¶¶‡ßç‡¶∞','‡¶Ü‡¶π‡¶ø','‡¶Æ‡¶ø‡¶§‡ßç‡¶∞','‡¶™‡¶ø‡¶§‡ßÉ','‡¶¨‡¶∏‡ßÅ','‡¶¨‡¶æ‡¶∞‡¶æ‡¶π','‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡ßá‡¶¶‡ßá‡¶¨','‡¶¨‡¶ø‡¶ß‡¶ø',
  '‡¶∏‡¶§‡¶Æ‡ßÅ‡¶ñ‡ßÄ','‡¶™‡ßÅ‡¶∞‡ßÅ‡¶π‡ßÇ‡¶§','‡¶¨‡¶æ‡¶π‡¶ø‡¶£‡ßÄ','‡¶®‡¶ï‡ßç‡¶§‡¶®‡¶ï‡¶∞‡¶æ','‡¶¨‡¶∞‡ßÅ‡¶£','‡¶Ö‡¶∞‡ßç‡¶Ø‡¶Æ‡¶®','‡¶≠‡¶ó','‡¶ó‡¶ø‡¶∞‡ßÄ‡¶∂',
  '‡¶Ö‡¶ú‡¶™‡¶æ‡¶¶','‡¶Ö‡¶π‡¶ø‡¶∞‡¶¨‡ßÅ‡¶ß','‡¶™‡ßÅ‡¶∑‡ßç‡¶Ø','‡¶Ö‡¶∂‡ßç‡¶¨‡¶ø‡¶®‡ßÄ','‡¶Ø‡¶Æ','‡¶Ö‡¶ó‡ßç‡¶®‡¶ø','‡¶¨‡¶ø‡¶ß‡¶æ‡¶§‡ßç‡¶∞‡ßÄ','‡¶ï‡¶æ‡¶£‡ßç‡¶°','‡¶Ö‡¶¶‡¶ø‡¶§‡¶ø'
];
// Auspiciousness: G=good/‡¶∂‡ßÅ‡¶≠, N=neutral/‡¶Æ‡¶ß‡ßç‡¶Ø‡¶Æ, B=bad/‡¶Ö‡¶∂‡ßÅ‡¶≠
const MUH_AUSPIC = ['B','B','G','B','G','G','G','G','G','G','G','B','G','G','G','G','B','N','G','G','B','G','G','G','G'];
const MUH_DESC = [
  '‡¶Ö‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§, ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶∞‡ßç‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º',
  '‡¶Ö‡¶∂‡ßÅ‡¶≠, ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶¨‡¶∞‡ßç‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º',
  '‡¶Æ‡¶ø‡¶§‡ßç‡¶∞‡¶§‡¶æ ‡¶ì ‡¶∏‡¶π‡¶Ø‡ßã‡¶ó‡¶ø‡¶§‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶™‡¶ø‡¶§‡ßÉ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶â‡¶™‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§',
  '‡¶ß‡¶®‡¶≤‡¶æ‡¶≠ ‡¶ì ‡¶∏‡¶Æ‡ßç‡¶™‡¶¶ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá ‡¶∂‡ßÅ‡¶≠',
  '‡¶ï‡ßÉ‡¶∑‡¶ø‡¶ï‡¶æ‡¶ú ‡¶ì ‡¶™‡¶∂‡ßÅ‡¶™‡¶æ‡¶≤‡¶®‡ßá ‡¶∂‡ßÅ‡¶≠',
  '‡¶ß‡¶∞‡ßç‡¶Æ‡ßÄ‡¶Ø‡¶º ‡¶ì ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶ú‡¶ø‡¶ï ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ',
  '‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶† ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶¨‡¶π‡ßÅ‡¶Æ‡ßÅ‡¶ñ‡ßÄ ‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø',
  '‡¶∞‡¶æ‡¶ú‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø ‡¶ì ‡¶∏‡¶≠‡¶æ-‡¶∏‡¶Æ‡¶ø‡¶§‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø',
  '‡¶≠‡ßç‡¶∞‡¶Æ‡¶£ ‡¶ì ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∂‡ßÅ‡¶≠',
  '‡¶Ö‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§, ‡¶¨‡¶∞‡ßç‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º',
  '‡¶ú‡¶≤‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø ‡¶ì ‡¶®‡ßå‡¶ï‡¶æ ‡¶ö‡¶æ‡¶≤‡¶®‡¶æ‡¶Ø‡¶º ‡¶∂‡ßÅ‡¶≠',
  '‡¶∏‡¶Æ‡ßÉ‡¶¶‡ßç‡¶ß‡¶ø ‡¶ì ‡¶Ü‡¶®‡¶®‡ßç‡¶¶‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶≠‡¶æ‡¶ó‡ßç‡¶Ø ‡¶ì ‡¶™‡ßç‡¶∞‡ßá‡¶Æ‡ßá ‡¶∂‡ßÅ‡¶≠',
  '‡¶∂‡¶ø‡¶¨ ‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ì ‡¶Ü‡¶ß‡ßç‡¶Ø‡¶æ‡¶§‡ßç‡¶Æ‡¶ø‡¶ï ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡ßá ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶†',
  '‡¶Ö‡¶∂‡ßÅ‡¶≠, ‡¶¨‡¶∞‡ßç‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º',
  '‡¶Æ‡¶ß‡ßç‡¶Ø‡¶Æ ‚Äî ‡¶¨‡¶ø‡¶¨‡ßá‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®',
  '‡¶™‡ßÅ‡¶∑‡ßç‡¶ü‡¶ø ‡¶ì ‡¶∏‡ßç‡¶¨‡¶æ‡¶∏‡ßç‡¶•‡ßç‡¶Ø‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ ‡¶ì ‡¶®‡¶ø‡¶∞‡¶æ‡¶Æ‡¶Ø‡¶º‡ßá ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶†',
  '‡¶™‡¶ø‡¶§‡ßÉ‡¶§‡¶∞‡ßç‡¶™‡¶£‡ßá‡¶∞ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶Ø‡¶ú‡ßç‡¶û ‡¶ì ‡¶π‡ßã‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶∏‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø ‡¶ì ‡¶â‡¶¶‡ßç‡¶≠‡¶æ‡¶¨‡¶®‡ßá‡¶∞ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
  '‡¶Æ‡¶æ‡¶§‡ßÉ‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ì ‡¶∏‡¶®‡ßç‡¶§‡¶æ‡¶®‡ßá‡¶∞ ‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤‡ßá ‡¶∂‡ßÅ‡¶≠'
];

// Rahu Kala times by weekday (traditional ‚Äî hours from sunrise)
// Sun=8th, Mon=2nd, Tue=7th, Wed=5th, Thu=6th, Fri=4th, Sat=3rd part
const RAHU_PART = [8,2,7,5,6,4,3]; // part number (1-8) from sunrise

// Yamaganda by weekday (1-8 from sunrise)
const YAMA_PART = [5,4,3,2,1,7,6];

// Gulika by weekday
const GULI_PART = [7,6,5,4,3,2,1];

function getMuhurtas(jd, bsMonth, weekday) {
  const sun = sunRiseSet(jd);
  const sun2 = sunRiseSet(jd + 1); // next day sunrise
  if (!sun.rise || !sun.set) return [];

  const riseH = sun.riseH;
  const setH  = sun.setH;
  const nextRiseH = sun2 ? sun2.riseH + 24 : riseH + 24;

  const dayDur   = setH - riseH;           // hours
  const nightDur = nextRiseH - setH;       // hours
  const muhDayDur   = dayDur / 15;         // 1 muhurta duration (day)
  const muhNightDur = nightDur / 15;       // 1 muhurta duration (night)

  // Rahu, Yama, Gulika (each = 1 muhurta duration, 1.5 hrs traditionally)
  const rahuStart = riseH + (RAHU_PART[weekday] - 1) * muhDayDur;
  const yamaStart = riseH + (YAMA_PART[weekday] - 1) * muhDayDur;
  const guliStart = riseH + (GULI_PART[weekday] - 1) * muhDayDur;

  function toHM(h) {
    const norm = ((h % 24) + 24) % 24;
    const hh = Math.floor(norm);
    const mm = Math.round((norm - hh) * 60);
    const mm2 = mm >= 60 ? 0 : mm;
    const hh2 = mm >= 60 ? hh + 1 : hh;
    return bn(hh2) + ':' + (mm2 < 10 ? '‡ß¶' + bn(mm2) : bn(mm2));
  }

  const mList = [];
  // Day muhurtas (1-15): Rudra...Aditi mapped to day hours
  for (let i = 0; i < 15; i++) {
    const s = riseH + i * muhDayDur;
    const e = s + muhDayDur;
    const isRahu = (Math.round(s * 10) === Math.round(rahuStart * 10));
    const isYama = (Math.round(s * 10) === Math.round(yamaStart * 10));
    const isGuli = (Math.round(s * 10) === Math.round(guliStart * 10));
    mList.push({
      num: i + 1, name: MUH_NAMES[i], auspic: MUH_AUSPIC[i],
      desc: MUH_DESC[i], start: toHM(s), end: toHM(e), startH: s,
      isRahu, isYama, isGuli, period: '‡¶¶‡¶ø‡¶®'
    });
  }
  // Night muhurtas (16-30): continuing cycle
  for (let i = 0; i < 10; i++) {
    const s = setH + i * muhNightDur;
    const e = s + muhNightDur;
    mList.push({
      num: i + 16, name: MUH_NAMES[i + 15], auspic: MUH_AUSPIC[i + 15],
      desc: MUH_DESC[i + 15], start: toHM(s), end: toHM(e), startH: s,
      isRahu: false, isYama: false, isGuli: false, period: '‡¶∞‡¶æ‡¶§'
    });
  }

  // Add Rahu Kala, Yamaganda, Gulika as special entries
  const rahuSE = { name:'‡¶∞‡¶æ‡¶π‡ßÅ ‡¶ï‡¶æ‡¶≤', auspic:'B', desc:'‡¶Ö‡¶∂‡ßÅ‡¶≠ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‚Äî ‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶∞‡ßç‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º',
    start: toHM(rahuStart), end: toHM(rahuStart + muhDayDur), startH: rahuStart, period:'‡¶¨‡¶ø‡¶∂‡ßá‡¶∑' };
  const yamaSE = { name:'‡¶Ø‡¶Æ‡¶ò‡¶£‡ßç‡¶ü', auspic:'B', desc:'‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∞‡¶Æ‡ßç‡¶≠ ‡¶®‡¶ø‡¶∑‡¶ø‡¶¶‡ßç‡¶ß',
    start: toHM(yamaStart), end: toHM(yamaStart + muhDayDur), startH: yamaStart, period:'‡¶¨‡¶ø‡¶∂‡ßá‡¶∑' };
  const guliSE = { name:'‡¶ó‡ßÅ‡¶≤‡¶ø‡¶ï ‡¶ï‡¶æ‡¶≤', auspic:'B', desc:'‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶¨‡¶ø‡¶∞‡¶§ ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®',
    start: toHM(guliStart), end: toHM(guliStart + muhDayDur), startH: guliStart, period:'‡¶¨‡¶ø‡¶∂‡ßá‡¶∑' };

  // Brahma muhurta: 1.5 hrs before sunrise
  const brahmaStart = riseH - 1.5;
  const brahmaSE = { name:'‡¶¨‡ßç‡¶∞‡¶π‡ßç‡¶Æ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§', auspic:'G', desc:'‡¶ß‡ßç‡¶Ø‡¶æ‡¶®, ‡¶™‡ßÇ‡¶ú‡¶æ, ‡¶Ö‡¶ß‡ßç‡¶Ø‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶∂‡ßç‡¶∞‡ßá‡¶∑‡ßç‡¶† ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
    start: toHM(brahmaStart), end: toHM(riseH), startH: brahmaStart, period:'‡¶≠‡ßã‡¶∞' };

  // Abhijit muhurta: around solar noon (varies by weekday, best on most days)
  const abhijitStart = sun.transit - 0.4;
  const abhijitSE = { name:'‡¶Ö‡¶≠‡¶ø‡¶ú‡¶ø‡ßé ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§', auspic:'G', desc:'‡¶∏‡¶ï‡¶≤ ‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∂‡ßÅ‡¶≠',
    start: toHM(abhijitStart), end: toHM(abhijitStart + 0.8), startH: abhijitStart, period:'‡¶¶‡ßÅ‡¶™‡ßÅ‡¶∞' };

  // Vijaya muhurta: 3rd muhurta of afternoon
  const vijayaStart = sun.transit + muhDayDur;
  const vijayaSE = { name:'‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§', auspic:'G', desc:'‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶ì ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∞‡¶Æ‡ßç‡¶≠‡ßá ‡¶∂‡ßÅ‡¶≠',
    start: toHM(vijayaStart), end: toHM(vijayaStart + muhDayDur), startH: vijayaStart, period:'‡¶¨‡¶ø‡¶ï‡ßá‡¶≤' };

  // Godhuli: ~30 min around sunset
  const godhuliStart = setH - 0.3;
  const godhuliSE = { name:'‡¶ó‡ßã‡¶ß‡ßÇ‡¶≤‡¶ø ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§', auspic:'G', desc:'‡¶¨‡¶ø‡¶¨‡¶æ‡¶π ‡¶ì ‡¶™‡ßÇ‡¶ú‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶∂‡ßÅ‡¶≠',
    start: toHM(godhuliStart), end: toHM(setH + 0.3), startH: godhuliStart, period:'‡¶∏‡¶®‡ßç‡¶ß‡ßç‡¶Ø‡¶æ' };

  // Nishith: ~midnight
  const nishithStart = setH + nightDur / 2 - 0.4;
  const nishithSE = { name:'‡¶®‡¶ø‡¶∂‡ßÄ‡¶• ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§', auspic:'N', desc:'‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞ ‡¶ì ‡¶Ü‡¶ß‡ßç‡¶Ø‡¶æ‡¶§‡ßç‡¶Æ‡¶ø‡¶ï ‡¶∏‡¶æ‡¶ß‡¶®‡¶æ‡¶∞ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§',
    start: toHM(nishithStart), end: toHM(nishithStart + 0.8), startH: nishithStart, period:'‡¶∞‡¶æ‡¶§' };

  return [brahmaSE, ...mList.slice(0,15), rahuSE, yamaSE, guliSE,
          abhijitSE, vijayaSE, godhuliSE, ...mList.slice(15), nishithSE];
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FESTIVALS ENGINE
   Hindu festivals are LUNAR (tithi-based) ‚Äî computed
   dynamically for each Bengali year using verified
   astronomical rules (Drik Siddhanta):
   ‚Ä¢ Sunrise rule (06:00 IST = 00:30 UTC): most festivals
   ‚Ä¢ Noon rule    (12:00 IST = 06:30 UTC): Saraswati Puja
   ‚Ä¢ Nishith rule (00:00 IST = 18:30 UTC prev): Shivaratri
   ‚Ä¢ Sunrise+1    after trayodashi: Dhanteras
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */

// Tithi at 06:00 IST (00:30 UTC) ‚Äî standard rule for most festivals
function getTithiAtSunrise(jdNoon) {
  return calcTithi(jdNoon - 0.5 + 0.5 / 24).num;
}
// Tithi at 12:00 IST (06:30 UTC) ‚Äî used for Saraswati (puja at noon)
function getTithiAtNoon(jdNoon) {
  return calcTithi(jdNoon - 0.5 + 6.5 / 24).num;
}
// Tithi at midnight IST (18:30 UTC of same integer JD) ‚Äî used for Shivaratri nishith
function getTithiAtNishith(jdNoon) {
  return calcTithi(jdNoon - 0.5 + 18.5 / 24).num;
}

// Generic tithi finder: scan from seedJD, using supplied tithiFn
function findTithiJDWith(tithiTarget, seedJD, tithiFn, preferLast) {
  preferLast = preferLast || false;
  let firstFound = null, lastFound = null;
  for (let off = -5; off <= 55; off++) {
    const jd = Math.floor(seedJD) + off;
    if (tithiFn(jd) === tithiTarget) {
      if (firstFound === null) firstFound = jd;
      lastFound = jd;
    } else if (firstFound !== null) break;
  }
  if (firstFound === null) return null;
  return preferLast ? lastFound : firstFound;
}

// Sunrise-based finder (standard rule)
function findTithiJD(tithiTarget, seedJD, preferLast) {
  return findTithiJDWith(tithiTarget, seedJD, getTithiAtSunrise, preferLast);
}
// Noon-based finder (Saraswati etc.)
function findTithiJDNoon(tithiTarget, seedJD, preferLast) {
  return findTithiJDWith(tithiTarget, seedJD, getTithiAtNoon, preferLast);
}
// Nishith-based finder (Shivaratri)
function findTithiJDNishith(tithiTarget, seedJD, preferLast) {
  return findTithiJDWith(tithiTarget, seedJD, getTithiAtNishith, preferLast);
}

// Convert JD to Bengali {y,m,d}
function jdToBs(jd) {
  const g = jdToGregorian(jd);
  return gregorianToBengali(g.y, g.m, g.d);
}

// Build complete festival list for a given Bengali year (bsY)
function buildFestsForYear(bsY) {
  const ceY = bsY + 593; // CE year for Jan-Dec portion
  const fests = [];

  function add(jd, name, e, t, tl, desc) {
    if (!jd) return;
    const bs = jdToBs(jd);
    if (bs.y === bsY) fests.push({ m: bs.m, d: bs.d, name, e, t, tl, desc });
  }

  // ‚îÄ‚îÄ TITHI-BASED HINDU FESTIVALS (verified against Drik Panchang 2025) ‚îÄ‚îÄ

  // Saraswati Puja = Magh Shukla Panchami (tithi 4) ‚Äî NOON rule
  // Panchami must prevail at noon (puja time). Seed: ~10 days before (Jan 22).
  add(findTithiJDNoon(4, gregorianToJD(ceY, 1, 22), false),
      '‡¶∏‡¶∞‡¶∏‡ßç‡¶¨‡¶§‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶¨‡¶∏‡¶®‡ßç‡¶§‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ','üìö','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶¨‡¶ø‡¶¶‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶¶‡ßá‡¶¨‡ßÄ‡¶∞ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶Æ‡¶æ‡¶ò ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ‡•§ ‡¶õ‡¶æ‡¶§‡ßç‡¶∞‡¶õ‡¶æ‡¶§‡ßç‡¶∞‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ß‡¶æ‡¶® ‡¶â‡ßé‡¶∏‡¶¨‡•§');

  // Maha Shivaratri = Falgun Krishna Chaturdashi (tithi 28) ‚Äî NISHITH rule
  // Observed on the night when Chaturdashi prevails at Nishith (midnight IST).
  add(findTithiJDNishith(28, gregorianToJD(ceY, 2, 10), false),
      '‡¶Æ‡¶π‡¶æ ‡¶∂‡¶ø‡¶¨‡¶∞‡¶æ‡¶§‡ßç‡¶∞‡¶ø','üî±','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶∂‡¶ø‡¶¨‡ßá‡¶∞ ‡¶Æ‡¶π‡¶æ‡¶∞‡¶æ‡¶§‡ßç‡¶∞‡¶ø‡•§ ‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶® ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶¶‡¶∂‡ßÄ‡•§ ‡¶â‡¶™‡¶¨‡¶æ‡¶∏, ‡¶∞‡¶æ‡¶§‡¶≠‡¶∞ ‡¶ú‡¶æ‡¶ó‡¶∞‡¶£ ‡¶ì ‡¶™‡ßÇ‡¶ú‡¶æ‡•§');

  // Dol Purnima / Holi = Falgun Purnima (tithi 14) ‚Äî SUNRISE preferLast
  const dolJD = findTithiJD(14, gregorianToJD(ceY, 3, 1), true);
  add(dolJD, '‡¶¶‡ßã‡¶≤ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ ‚Äî ‡¶π‡ßã‡¶≤‡¶ø','üé®','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶® ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§ ‡¶∞‡¶ô‡ßá‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§ ‡¶∞‡¶æ‡¶ß‡¶æ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡ßá‡¶∞ ‡¶¶‡ßã‡¶≤‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ‡•§ ‡¶Ü‡¶¨‡¶ø‡¶∞ ‡¶ñ‡ßá‡¶≤‡¶æ‡•§');
  add(dolJD, '‡¶ö‡ßà‡¶§‡¶®‡ßç‡¶Ø ‡¶Æ‡¶π‡¶æ‡¶™‡ßç‡¶∞‡¶≠‡ßÅ‡¶∞ ‡¶Ü‡¶¨‡¶ø‡¶∞‡ßç‡¶≠‡¶æ‡¶¨ ‡¶§‡¶ø‡¶•‡¶ø','üôè','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶∂‡ßç‡¶∞‡ßÄ‡¶ö‡ßà‡¶§‡¶®‡ßç‡¶Ø ‡¶Æ‡¶π‡¶æ‡¶™‡ßç‡¶∞‡¶≠‡ßÅ‡¶∞ ‡¶Ü‡¶¨‡¶ø‡¶∞‡ßç‡¶≠‡¶æ‡¶¨ ‡¶§‡¶ø‡¶•‡¶ø‡•§ ‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶® ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§');

  // Ram Navami = Chaitra Shukla Navami (tithi 8) ‚Äî SUNRISE
  add(findTithiJD(8, gregorianToJD(ceY, 3, 22), false),
      '‡¶∞‡¶æ‡¶Æ‡¶®‡¶¨‡¶Æ‡ßÄ','üèπ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶≠‡¶ó‡¶¨‡¶æ‡¶® ‡¶∞‡¶æ‡¶Æ‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶§‡¶ø‡¶•‡¶ø‡•§ ‡¶ö‡ßà‡¶§‡ßç‡¶∞ ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶®‡¶¨‡¶Æ‡ßÄ‡•§');

  // Hanuman Jayanti = Chaitra Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 3, 29), true),
      '‡¶π‡¶®‡ßÅ‡¶Æ‡¶æ‡¶® ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','üêí','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶∂‡ßç‡¶∞‡ßÄ ‡¶π‡¶®‡ßÅ‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ‡•§ ‡¶ö‡ßà‡¶§‡ßç‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§');

  // Akshaya Tritiya = Vaishakh Shukla Tritiya (tithi 2) ‚Äî SUNRISE
  // Seed from Apr 20; tithi 2 first appears at sunrise on correct day.
  add(findTithiJD(2, gregorianToJD(ceY, 4, 17), false),
      '‡¶Ö‡¶ï‡ßç‡¶∑‡¶Ø‡¶º ‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ','ü™ô','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∂‡ßÅ‡¶≠ ‡¶¶‡¶ø‡¶®‡•§ ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶§‡ßÉ‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ‡•§ ‡¶∏‡ßã‡¶®‡¶æ ‡¶ï‡ßá‡¶®‡¶æ, ‡¶¨‡¶ø‡¶¨‡¶æ‡¶π, ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶∞‡ßÅ‡•§');

  // Buddha Purnima = Vaishakh Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 4, 28), true),
      '‡¶¨‡ßÅ‡¶¶‡ßç‡¶ß ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ','‚ò∏Ô∏è','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ó‡ßå‡¶§‡¶Æ ‡¶¨‡ßÅ‡¶¶‡ßç‡¶ß‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ, ‡¶ú‡ßç‡¶û‡¶æ‡¶®‡¶≤‡¶æ‡¶≠ ‡¶ì ‡¶Æ‡¶π‡¶æ‡¶™‡¶∞‡¶ø‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶£‡•§ ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§');

  // Rath Yatra = Ashadh Shukla Dvitiya (tithi 1) ‚Äî SUNRISE
  const rathJD = findTithiJD(1, gregorianToJD(ceY, 6, 16), false);
  add(rathJD, '‡¶∞‡¶•‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ','üé°','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶≠‡¶ó‡¶¨‡¶æ‡¶® ‡¶ú‡¶ó‡¶®‡ßç‡¶®‡¶æ‡¶•‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡¶æ‡¶≤ ‡¶∞‡¶• ‡¶ü‡¶æ‡¶®‡¶æ‡¶∞ ‡¶Æ‡¶π‡ßã‡ßé‡¶∏‡¶¨‡•§ ‡¶Ü‡¶∑‡¶æ‡¶¢‡¶º ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ‡•§');
  if (rathJD) add(rathJD + 9, '‡¶â‡¶≤‡ßç‡¶ü‡ßã ‡¶∞‡¶•‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ','üîÑ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ó‡ßÅ‡¶£‡ßç‡¶°‡¶ø‡¶ö‡¶æ ‡¶Æ‡¶®‡ßç‡¶¶‡¶ø‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶ú‡¶ó‡¶®‡ßç‡¶®‡¶æ‡¶•‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡¶æ‡¶¨‡¶∞‡ßç‡¶§‡¶®‡•§ ‡¶Ü‡¶∑‡¶æ‡¶¢‡¶º ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ‡•§');

  // Guru Purnima = Ashadh Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 6, 26), true),
      '‡¶ó‡ßÅ‡¶∞‡ßÅ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ','üôè','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∂‡ßç‡¶∞‡¶¶‡ßç‡¶ß‡¶æ ‡¶®‡¶ø‡¶¨‡ßá‡¶¶‡¶®‡•§ ‡¶Ü‡¶∑‡¶æ‡¶¢‡¶º ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§ ‡¶¨‡ßå‡¶¶‡ßç‡¶ß ‡¶¨‡¶∞‡ßç‡¶∑‡¶æ‡¶¨‡¶æ‡¶∏ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡•§');

  // Nag Panchami = Shravan Shukla Panchami (tithi 4) ‚Äî SUNRISE
  add(findTithiJD(4, gregorianToJD(ceY, 7, 18), false),
      '‡¶®‡¶æ‡¶ó ‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ','üêç','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶∏‡¶∞‡ßç‡¶™‡¶¶‡ßá‡¶¨‡¶§‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶∂‡ßç‡¶∞‡¶æ‡¶¨‡¶£ ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ö‡¶Æ‡ßÄ‡•§');

  // Raksha Bandhan = Shravan Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 7, 25), true),
      '‡¶∞‡¶æ‡¶ñ‡ßÄ ‡¶¨‡¶®‡ßç‡¶ß‡¶®','üéÄ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶≠‡¶æ‡¶á-‡¶¨‡ßã‡¶®‡ßá‡¶∞ ‡¶™‡¶¨‡¶ø‡¶§‡ßç‡¶∞ ‡¶¨‡¶®‡ßç‡¶ß‡¶®‡ßá‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§ ‡¶∂‡ßç‡¶∞‡¶æ‡¶¨‡¶£ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§');

  // Janmashtami = Bhadra Krishna Ashtami (tithi 22) ‚Äî SUNRISE
  add(findTithiJD(22, gregorianToJD(ceY, 8, 5), false),
      '‡¶ú‡¶®‡ßç‡¶Æ‡¶æ‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ','ü¶ö','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶∂‡ßç‡¶∞‡ßÄ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶§‡¶ø‡¶•‡¶ø‡•§ ‡¶≠‡¶æ‡¶¶‡ßç‡¶∞ ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ‡•§ ‡¶Æ‡¶ß‡ßç‡¶Ø‡¶∞‡¶æ‡¶§‡ßá ‡¶™‡ßÇ‡¶ú‡¶æ, ‡¶â‡¶™‡¶¨‡¶æ‡¶∏‡•§');

  // Ganesh Chaturthi = Bhadra Shukla Chaturthi (tithi 3) ‚Äî SUNRISE
  add(findTithiJD(3, gregorianToJD(ceY, 8, 18), false),
      '‡¶ó‡¶£‡ßá‡¶∂ ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ','üêò','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶¨‡¶æ‡¶ß‡¶æ‡¶¨‡¶ø‡¶®‡¶æ‡¶∂‡¶ï ‡¶¶‡ßá‡¶¨‡¶§‡¶æ ‡¶ó‡¶£‡ßá‡¶∂‡ßá‡¶∞ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶≠‡¶æ‡¶¶‡ßç‡¶∞ ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ‡•§');

  // Mahalaya = Ashwin Krishna Amavasya (tithi 29) ‚Äî SUNRISE preferLast
  add(findTithiJD(29, gregorianToJD(ceY, 9, 8), true),
      '‡¶Æ‡¶π‡¶æ‡¶≤‡¶Ø‡¶º‡¶æ','ü™î','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶™‡¶ø‡¶§‡ßÉ‡¶™‡¶ï‡ßç‡¶∑ ‡¶∂‡ßá‡¶∑‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶Ö‡¶Æ‡¶æ‡¶¨‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶¶‡ßá‡¶¨‡ßÄ‡¶™‡¶ï‡ßç‡¶∑‡ßá‡¶∞ ‡¶∏‡ßÇ‡¶ö‡¶®‡¶æ‡•§ ‡¶Æ‡¶π‡¶ø‡¶∑‡¶æ‡¶∏‡ßÅ‡¶∞‡¶Æ‡¶∞‡ßç‡¶¶‡¶ø‡¶®‡ßÄ‡•§');

  // Durga Puja ‚Äî seeded from Mahalaya
  const mhJD = findTithiJD(29, gregorianToJD(ceY, 9, 8), false) || gregorianToJD(ceY, 9, 19);
  add(findTithiJD(5,  mhJD + 4, true),  '‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶Æ‡¶π‡¶æ‡¶∑‡¶∑‡ßç‡¶†‡ßÄ','üå∫','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶¶‡ßá‡¶¨‡ßÄ‡¶∞ ‡¶¨‡ßã‡¶ß‡¶®‡•§ ‡¶∂‡¶æ‡¶∞‡¶¶‡ßÄ‡¶Ø‡¶º‡¶æ ‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ‡¶™‡ßÇ‡¶ú‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶∞‡ßÅ‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶∑‡¶∑‡ßç‡¶†‡ßÄ‡•§');
  add(findTithiJD(6,  mhJD + 5, false), '‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶Æ‡¶π‡¶æ‡¶∏‡¶™‡ßç‡¶§‡¶Æ‡ßÄ','üèµÔ∏è','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶ï‡¶≤‡¶æ‡¶¨‡¶â ‡¶∏‡ßç‡¶®‡¶æ‡¶® ‡¶ì ‡¶®‡¶¨‡¶™‡¶§‡ßç‡¶∞‡¶ø‡¶ï‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶∏‡¶™‡ßç‡¶§‡¶Æ‡ßÄ‡•§');
  add(findTithiJD(7,  mhJD + 6, false), '‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶Æ‡¶π‡¶æ‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ','üî•','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∏‡¶®‡ßç‡¶ß‡¶ø‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ì ‡¶ï‡ßÅ‡¶Æ‡¶æ‡¶∞‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ‡ßÄ‡•§');
  add(findTithiJD(8,  mhJD + 7, false), '‡¶¶‡ßÅ‡¶∞‡ßç‡¶ó‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶Æ‡¶π‡¶æ‡¶®‡¶¨‡¶Æ‡ßÄ','üå∏','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶®‡¶¨‡¶Æ‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ì ‡¶π‡ßã‡¶Æ‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶®‡¶¨‡¶Æ‡ßÄ‡•§');
  add(findTithiJD(9,  mhJD + 8, true),  '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡¶æ ‡¶¶‡¶∂‡¶Æ‡ßÄ','üéÜ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶Æ‡¶æ ‡¶¨‡¶ø‡¶∏‡¶∞‡ßç‡¶ú‡¶®‡•§ ‡¶∏‡¶ø‡¶Å‡¶¶‡ßÅ‡¶∞ ‡¶ñ‡ßá‡¶≤‡¶æ‡•§ ‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶¶‡¶∂‡¶Æ‡ßÄ‡•§');

  // Kojagari Lakshmi = Ashwin Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 9, 26), true),
      '‡¶ï‡ßã‡¶ú‡¶æ‡¶ó‡¶∞‡ßÄ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ','üåù','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶Ü‡¶∂‡ßç‡¶¨‡¶ø‡¶® ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡¶Ø‡¶º ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Æ‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶ï‡ßã‡¶ú‡¶æ‡¶ó‡¶∞ ‡¶∞‡¶æ‡¶§‡•§');

  // Dhanteras = day AFTER last sunrise with Trayodashi (tithi 27)
  // Traditional: observed on the day Chaturdashi begins = day trayodashi ends at sunrise + 1
  const dhanteraTray = findTithiJD(27, gregorianToJD(ceY, 10, 6), true);
  if (dhanteraTray) add(dhanteraTray + 1, '‡¶ß‡¶®‡¶§‡ßá‡¶∞‡¶æ‡¶∏','üíõ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑‡•§ ‡¶∏‡ßã‡¶®‡¶æ-‡¶∞‡ßÅ‡¶™‡¶æ ‡¶ï‡ßá‡¶®‡¶æ‡¶∞ ‡¶∂‡ßÅ‡¶≠ ‡¶¶‡¶ø‡¶®‡•§ ‡¶ß‡¶®‡¶¨‡¶®‡ßç‡¶§‡¶∞‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§');

  // Kali Puja / Diwali = Kartik Amavasya (tithi 29) ‚Äî SUNRISE preferLast
  add(findTithiJD(29, gregorianToJD(ceY, 10, 8), true),
      '‡¶ï‡¶æ‡¶≤‡ßÄ ‡¶™‡ßÇ‡¶ú‡¶æ ‚Äî ‡¶¶‡ßÄ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø','üïØÔ∏è','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ï‡¶æ‡¶≤‡ßÄ ‡¶Æ‡¶æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï ‡¶Ö‡¶Æ‡¶æ‡¶¨‡¶∏‡ßç‡¶Ø‡¶æ‡•§ ‡¶Ü‡¶≤‡ßã‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§');

  // Bhai Phota = Kartik Shukla Dvitiya (tithi 1) ‚Äî SUNRISE preferLast
  add(findTithiJD(1, gregorianToJD(ceY, 10, 14), true),
      '‡¶≠‡¶æ‡¶á ‡¶´‡ßã‡¶Å‡¶ü‡¶æ','ü§ù','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ',
      '‡¶≠‡¶æ‡¶á‡¶Ø‡¶º‡ßá‡¶∞ ‡¶ï‡¶™‡¶æ‡¶≤‡ßá ‡¶´‡ßã‡¶Å‡¶ü‡¶æ‡•§ ‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º‡¶æ‡•§ ‡¶¶‡ßÄ‡¶∞‡ßç‡¶ò‡¶æ‡¶Ø‡¶º‡ßÅ ‡¶ï‡¶æ‡¶Æ‡¶®‡¶æ‡•§');

  // Kartik Purnima / Ras Purnima (tithi 14) ‚Äî SUNRISE preferLast
  add(findTithiJD(14, gregorianToJD(ceY, 10, 22), true),
      '‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ ‚Äî ‡¶∞‡¶æ‡¶∏ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ','üåï','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶ï‡¶æ‡¶∞‡ßç‡¶§‡¶ø‡¶ï ‡¶™‡ßÇ‡¶∞‡ßç‡¶£‡¶ø‡¶Æ‡¶æ‡•§ ‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡ßá‡¶∞ ‡¶∞‡¶æ‡¶∏‡¶≤‡ßÄ‡¶≤‡¶æ‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§ ‡¶¶‡ßá‡¶¨ ‡¶¶‡ßÄ‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡•§');

  // Gita Jayanti = Margashirsha Shukla Ekadashi (tithi 10) ‚Äî SUNRISE
  add(findTithiJD(10, gregorianToJD(ceY, 11, 18), false),
      '‡¶ó‡ßÄ‡¶§‡¶æ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','üìñ','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',
      '‡¶≠‡¶ó‡¶¨‡¶¶‡ßç‡¶ó‡ßÄ‡¶§‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶¨‡¶ö‡¶® ‡¶¶‡¶ø‡¶¨‡¶∏‡•§ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶π‡¶æ‡¶Ø‡¶º‡¶£ ‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ‡•§');

  // ‚îÄ‚îÄ FIXED GREGORIAN ‚Üí BENGALI ‚îÄ‚îÄ
  function fixedGreg(gy, gm, gd, name, e, t, tl, desc) {
    const bs = gregorianToBengali(gy, gm, gd);
    if (bs.y === bsY) fests.push({ m: bs.m, d: bs.d, name, e, t, tl, desc });
  }
  // Fixed Bengali calendar dates (always same Bengali date)
  function fixedBS(bm, bd, name, e, t, tl, desc) {
    fests.push({ m: bm, d: bd, name, e, t, tl, desc });
  }

  // ‚îÄ‚îÄ EKADASHI list for the year (tithi 10 = Shukla Ekadashi, 25 = Krishna Ekadashi) ‚îÄ‚îÄ
  // Ekadashi = 11th tithi (index 10 in Shukla, index 25 in Krishna)
  // Add major named Ekadashis
  const ekadashiSeeds = [
    { seed: gregorianToJD(ceY, 1, 10),  nameS: '‡¶™‡ßÅ‡¶§‡ßç‡¶∞‡¶¶‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶∑‡¶ü‡¶§‡¶ø‡¶≤‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 2, 10),  nameS: '‡¶ú‡¶Ø‡¶º‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ',    nameK: '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 3, 10),  nameS: '‡¶Ü‡¶Æ‡¶≤‡¶ï‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ',  nameK: '‡¶™‡¶æ‡¶™‡¶Æ‡ßã‡¶ö‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 4, 10),  nameS: '‡¶ï‡¶æ‡¶Æ‡¶¶‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ',   nameK: '‡¶¨‡¶∞‡ßÅ‡¶•‡¶ø‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 5, 10),  nameS: '‡¶Æ‡ßã‡¶π‡¶ø‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶Ö‡¶™‡¶∞‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 6, 10),  nameS: '‡¶®‡¶ø‡¶∞‡ßç‡¶ú‡¶≤‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶Ø‡ßã‡¶ó‡¶ø‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 7, 10),  nameS: '‡¶¶‡ßá‡¶¨‡¶∂‡¶Ø‡¶º‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶ï‡¶æ‡¶Æ‡¶ø‡¶ï‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 8, 10),  nameS: '‡¶™‡ßÅ‡¶§‡ßç‡¶∞‡¶¶‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶Ö‡¶ú‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 9, 10),  nameS: '‡¶™‡¶æ‡¶∞‡ßç‡¶∂‡ßç‡¶¨ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶á‡¶®‡ßç‡¶¶‡¶ø‡¶∞‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 10, 10), nameS: '‡¶™‡¶æ‡¶∂‡¶æ‡¶ô‡ßç‡¶ï‡ßÅ‡¶∂‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶∞‡¶Æ‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 11, 10), nameS: '‡¶¶‡ßá‡¶¨‡¶â‡¶†‡¶®‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶â‡ßé‡¶™‡¶§‡ßç‡¶§‡¶ø ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
    { seed: gregorianToJD(ceY, 12, 10), nameS: '‡¶Æ‡ßã‡¶ï‡ßç‡¶∑‡¶¶‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ', nameK: '‡¶∏‡¶´‡¶≤‡¶æ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ' },
  ];
  ekadashiSeeds.forEach(({ seed, nameS, nameK }) => {
    add(findTithiJD(10, seed, false), nameS + ' (‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ)','üåø','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶â‡¶™‡¶¨‡¶æ‡¶∏‡•§ ‡¶¨‡¶ø‡¶∑‡ßç‡¶£‡ßÅ‡¶∞ ‡¶Ü‡¶∞‡¶æ‡¶ß‡¶®‡¶æ‡¶∞ ‡¶™‡¶¨‡¶ø‡¶§‡ßç‡¶∞ ‡¶§‡¶ø‡¶•‡¶ø‡•§');
    add(findTithiJD(25, seed, false), nameK + ' (‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ)','üåø','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶â‡¶™‡¶¨‡¶æ‡¶∏‡•§ ‡¶¨‡¶ø‡¶∑‡ßç‡¶£‡ßÅ‡¶∞ ‡¶Ü‡¶∞‡¶æ‡¶ß‡¶®‡¶æ‡¶∞ ‡¶™‡¶¨‡¶ø‡¶§‡ßç‡¶∞ ‡¶§‡¶ø‡¶•‡¶ø‡•§');
  });

  // ‚îÄ‚îÄ Auspicious Yoga days (Amrit Siddhi + Sarvartha Siddhi) ‚îÄ‚îÄ
  // Amrit Siddhi Yoga: specific weekday + nakshatra combinations
  // Sarvartha Siddhi: Sunday+Hasta, Monday+Mrigashira, Tuesday+Ashvini, Wednesday+Anuradha,
  //                   Thursday+Pushya, Friday+Revati, Saturday+Rohini
  // Sarvartha Siddhi Yoga ‚Äî full year scan
  const SARVARTHA_NK_LOC = [12,4,0,16,7,26,3];
  for (let offS = 0; offS < 366; offS++) {
    const jdS = Math.floor(gregorianToJD(ceY, 1, 1)) + offS;
    const gS  = jdToGregorian(jdS);
    const wdS = new Date(gS.y, gS.m-1, gS.d).getDay();
    const nakS= calcNakshatra(jdS - 0.5 + 0.5/24);
    if (nakS.idx === SARVARTHA_NK_LOC[wdS]) {
      add(jdS, '‡¶∏‡¶∞‡ßç‡¶¨‡¶æ‡¶∞‡ßç‡¶• ‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶ø ‡¶Ø‡ßã‡¶ó','‚≠ê','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∏‡¶ï‡¶≤ ‡¶ï‡¶æ‡¶ú‡ßá ‡¶∏‡¶æ‡¶´‡¶≤‡ßç‡¶Ø‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶∂‡ßÅ‡¶≠ ‡¶Ø‡ßã‡¶ó‡•§ ‡¶∂‡ßÅ‡¶≠ ‡¶ï‡¶æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∞‡¶Æ‡ßç‡¶≠‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ‡•§');
    }
  }

  // ‚îÄ‚îÄ Fixed Bengali calendar dates ‚îÄ‚îÄ
  fixedBS(0, 1,  '‡¶™‡¶π‡ßá‡¶≤‡¶æ ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ ‚Äî ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶®‡¶¨‡¶¨‡¶∞‡ßç‡¶∑','üéä','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤ ‡¶∂‡ßã‡¶≠‡¶æ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ, ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡ßÄ ‡¶Æ‡ßá‡¶≤‡¶æ, ‡¶π‡¶æ‡¶≤‡¶ñ‡¶æ‡¶§‡¶æ‡•§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶¨‡¶°‡¶º ‡¶â‡ßé‡¶∏‡¶¨‡•§');
  fixedBS(0, 1,  '‡¶π‡¶æ‡¶≤‡¶ñ‡¶æ‡¶§‡¶æ','üìí','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶Ø‡¶º‡ßÄ‡¶¶‡ßá‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ñ‡¶æ‡¶§‡¶æ ‡¶ñ‡ßã‡¶≤‡¶æ‡¶∞ ‡¶ê‡¶§‡¶ø‡¶π‡ßç‡¶Ø‡¶¨‡¶æ‡¶π‡ßÄ ‡¶¶‡¶ø‡¶®‡•§');
  fixedBS(0, 25, '‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','‚úçÔ∏è','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶ï‡¶¨‡¶ø ‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶®‡¶æ‡¶• ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ (‡ß®‡ß´‡¶∂‡ßá ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ)‡•§');
  fixedBS(1, 11, '‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','üéµ','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶ï‡¶¨‡¶ø ‡¶ï‡¶æ‡¶ú‡ßÄ ‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ (‡ßß‡ßß‡¶á ‡¶ú‡ßç‡¶Ø‡ßà‡¶∑‡ßç‡¶†)‡•§');
  fixedBS(4, 31, '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨‡¶ï‡¶∞‡ßç‡¶Æ‡¶æ ‡¶™‡ßÇ‡¶ú‡¶æ','‚öôÔ∏è','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∂‡¶ø‡¶≤‡ßç‡¶™-‡¶ï‡¶æ‡¶∞‡¶ø‡¶ó‡¶∞‡¶¶‡ßá‡¶∞ ‡¶¶‡ßá‡¶¨‡¶§‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶ú‡¶æ‡•§ ‡¶≠‡¶æ‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑ ‡¶¶‡¶ø‡¶® (‡ßß‡ß≠ ‡¶∏‡ßá‡¶™‡ßç‡¶ü‡ßá‡¶Æ‡ßç‡¶¨‡¶∞)‡•§');

  // ‚îÄ‚îÄ Shubh Vivah (auspicious marriage) dates ‚îÄ‚îÄ
  // Traditional criteria: Shukla paksha, tithis 2/3/5/7/10/11/13, nakshatras Rohini/Mrigashira/Hasta/Chitra/Swati/Anuradha/Uttara Phalguni/Uttara Ashadha/Uttara Bhadrapada/Revati
  // Months allowed: Agrahayan, Phalgun, Vaishakh, Jyaistha, Magh (avoided: Ashwin, Kartik, Paush)
  const VIVAH_TITHIS = new Set([1,2,4,6,9,10,12]);
  const VIVAH_NAKSH  = new Set([3,4,11,12,14,16,26]);
  const VIVAH_MONTHS_BN = new Set([0,1,5,9,10]); // Vaishakh,Jyaistha,Ashwin,Magh,Falgun ‚Äî approx
  for (let off = 0; off < 365; off++) {
    const jd = Math.floor(gregorianToJD(ceY, 4, 14)) + off;
    const t2 = calcTithi(jd - 0.5 + 0.5/24);
    const nak2 = calcNakshatra(jd - 0.5 + 0.5/24);
    const bs2 = jdToBs(jd);
    if (bs2.y === bsY &&
        t2.num < 15 && VIVAH_TITHIS.has(t2.num) &&
        VIVAH_NAKSH.has(nak2.idx) &&
        VIVAH_MONTHS_BN.has(bs2.m)) {
      const g3 = jdToGregorian(jd);
      const wd3 = new Date(g3.y, g3.m-1, g3.d).getDay();
      if (wd3 !== 0) { // avoid Sunday
        add(jd, '‡¶∂‡ßÅ‡¶≠ ‡¶¨‡¶ø‡¶¨‡¶æ‡¶π ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§','üíç','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',`‡¶∂‡ßÅ‡¶≠ ‡¶¨‡¶ø‡¶¨‡¶æ‡¶π‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶â‡¶§‡ßç‡¶§‡¶Æ ‡¶§‡¶ø‡¶•‡¶ø-‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞ ‡¶Ø‡ßã‡¶ó‡•§ ‡¶§‡¶ø‡¶•‡¶ø: ${TITHIS_30[t2.num]}, ‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞: ${NAKSH[nak2.idx]}‡•§`);
      }
    }
  }

  // ‚îÄ‚îÄ Griha Pravesh (housewarming) auspicious dates ‚îÄ‚îÄ
  // Criteria: Shukla paksha, tithis 2/3/5/10/11/13, nakshatras Rohini/Mrigashira/Pushya/Hasta/Chitra/Anuradha/Uttara Phalguni/Uttara Bhadrapada/Revati, months avoided: Ashwin
  const GRIH_NAKSH = new Set([3,4,7,12,13,16,11,25,26]);
  for (let off2 = 0; off2 < 365; off2++) {
    const jd2 = Math.floor(gregorianToJD(ceY, 4, 14)) + off2;
    const t3 = calcTithi(jd2 - 0.5 + 0.5/24);
    const nak3 = calcNakshatra(jd2 - 0.5 + 0.5/24);
    const bs3 = jdToBs(jd2);
    if (bs3.y === bsY &&
        t3.num < 15 && VIVAH_TITHIS.has(t3.num) &&
        GRIH_NAKSH.has(nak3.idx) &&
        bs3.m !== 5) { // not Ashwin
      add(jd2, '‡¶ó‡ßÉ‡¶π‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§','üè†','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ',`‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶æ‡¶°‡¶º‡¶ø‡¶§‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠ ‡¶§‡¶ø‡¶•‡¶ø‡•§ ‡¶§‡¶ø‡¶•‡¶ø: ${TITHIS_30[t3.num]}, ‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞: ${NAKSH[nak3.idx]}‡•§`);
    }
  }
  fixedBS(10, 1, '‡¶™‡¶π‡ßá‡¶≤‡¶æ ‡¶´‡¶æ‡¶≤‡ßç‡¶ó‡ßÅ‡¶® ‚Äî ‡¶¨‡¶∏‡¶®‡ßç‡¶§ ‡¶â‡ßé‡¶∏‡¶¨','üå∏','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶¨‡¶∏‡¶®‡ßç‡¶§ ‡¶â‡¶¶‡¶Ø‡¶æ‡¶™‡¶®‡•§ ‡¶π‡¶≤‡ßÅ‡¶¶ ‡¶∂‡¶æ‡¶°‡¶º‡¶ø, ‡¶´‡ßÅ‡¶≤‡ßá‡¶∞ ‡¶Æ‡ßá‡¶≤‡¶æ‡•§');
  fixedBS(11, 30,'‡¶ö‡ßà‡¶§‡ßç‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø','üéã','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶™‡ßÅ‡¶∞‡¶®‡ßã ‡¶¨‡¶õ‡¶∞ ‡¶¨‡¶ø‡¶¶‡¶æ‡¶Ø‡¶º‡•§ ‡¶Æ‡ßá‡¶≤‡¶æ, ‡¶ö‡¶°‡¶º‡¶ï ‡¶™‡ßÇ‡¶ú‡¶æ ‡¶ì ‡¶ó‡¶æ‡¶ú‡¶® ‡¶â‡ßé‡¶∏‡¶¨‡•§');

  // ‚îÄ‚îÄ Fixed Gregorian dates (national / international) ‚îÄ‚îÄ
  // ‚îÄ‚îÄ Islamic festivals (Hijri-based, approximate Gregorian conversion) ‚îÄ‚îÄ
  // Eid ul-Fitr = 1 Shawwal (Hijri month 10) ‚Äî approximate
  function hijriToJD(hy, hm, hd) {
    const N = Math.floor((11*hy + 3) / 30) + 354*(hy-1) + 30*(hm-1) - Math.floor((hm-1)/2) + hd + 1948440 - 385;
    return N;
  }
  // Approximate Hijri year for this CE year
  const hYear = Math.floor((ceY - 622) * (33/32)) + 1;
  const eidFitrJD = hijriToJD(hYear, 10, 1);
  add(eidFitrJD, '‡¶à‡¶¶‡ßÅ‡¶≤ ‡¶´‡¶ø‡¶§‡¶∞ ‚Äî ‡¶∞‡ßã‡¶ú‡¶æ‡¶∞ ‡¶à‡¶¶','üåô','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶∞‡¶Æ‡¶ú‡¶æ‡¶® ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá ‡¶à‡¶¶‡ßÅ‡¶≤ ‡¶´‡¶ø‡¶§‡¶∞ ‡¶â‡¶¶‡¶Ø‡¶æ‡¶™‡¶®‡•§ ‡¶∂‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶≤‡ßá‡¶∞ ‡ßß ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡•§');
  const eidAdhaJD = hijriToJD(hYear, 12, 10);
  add(eidAdhaJD, '‡¶à‡¶¶‡ßÅ‡¶≤ ‡¶Ü‡¶Ø‡¶π‡¶æ ‚Äî ‡¶ï‡ßÅ‡¶∞‡¶¨‡¶æ‡¶®‡¶ø‡¶∞ ‡¶à‡¶¶','üêë','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶ú‡¶ø‡¶≤‡¶π‡¶ú ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡ßß‡ß¶ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡•§ ‡¶ï‡ßÅ‡¶∞‡¶¨‡¶æ‡¶®‡¶ø ‡¶ì ‡¶π‡¶ú‡ßç‡¶ú‡ßá‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§');
  const shabbEBaratJD = hijriToJD(hYear, 8, 15);
  add(shabbEBaratJD, '‡¶∂‡¶¨‡ßá ‡¶¨‡¶∞‡¶æ‡¶§','üïå','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶∂‡¶æ‡¶¨‡¶æ‡¶® ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡ßß‡ß´‡¶§‡¶Æ ‡¶∞‡¶æ‡¶§‡•§ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ ‡¶ì ‡¶∞‡¶π‡¶Æ‡¶§‡ßá‡¶∞ ‡¶∞‡¶æ‡¶§‡•§');
  const shabbEQadrJD = hijriToJD(hYear, 9, 27);
  add(shabbEQadrJD, '‡¶∂‡¶¨‡ßá ‡¶ï‡¶¶‡¶∞','‚≠ê','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶∞‡¶Æ‡¶ú‡¶æ‡¶®‡ßá‡¶∞ ‡ß®‡ß≠‡¶§‡¶Æ ‡¶∞‡¶æ‡¶§‡•§ ‡¶≤‡¶æ‡¶á‡¶≤‡¶æ‡¶§‡ßÅ‡¶≤ ‡¶ï‡¶¶‡¶∞ ‚Äî ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ‡•§');
  const eidMiladJD = hijriToJD(hYear, 3, 12);
  add(eidMiladJD, '‡¶à‡¶¶‡ßá ‡¶Æ‡¶ø‡¶≤‡¶æ‡¶¶‡ßÅ‡¶®‡ßç‡¶®‡¶¨‡ßÄ','üåü','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶®‡¶¨‡ßÄ ‡¶Æ‡ßÅ‡¶π‡¶æ‡¶Æ‡ßç‡¶Æ‡¶¶ (‡¶∏‡¶æ.)-‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡•§ ‡¶∞‡¶¨‡¶ø‡¶â‡¶≤ ‡¶Ü‡¶â‡¶Ø‡¶º‡¶æ‡¶≤ ‡ßß‡ß®‡•§');
  // Muharram / Ashura
  const ashuraJD = hijriToJD(hYear, 1, 10);
  add(ashuraJD, '‡¶Ü‡¶∂‡ßÅ‡¶∞‡¶æ ‚Äî ‡¶Æ‡¶π‡¶∞‡¶∞‡¶Æ','üñ§','tm','‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ','‡¶Æ‡¶π‡¶∞‡¶∞‡¶Æ‡ßá‡¶∞ ‡ßß‡ß¶ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ‡•§ ‡¶π‡¶ú‡¶∞‡¶§ ‡¶á‡¶Æ‡¶æ‡¶Æ ‡¶π‡ßã‡¶∏‡ßá‡¶®‡ßá‡¶∞ ‡¶∂‡¶æ‡¶π‡¶æ‡¶¶‡¶§‡•§');

  // ‚îÄ‚îÄ Christian festivals (fixed Gregorian) ‚îÄ‚îÄ
  // Easter (approximate ‚Äî Western)
  function easterJD(y) {
    const a=y%19, b=Math.floor(y/100), c=y%100, d=Math.floor(b/4), e=b%4;
    const f=Math.floor((b+8)/25), g=Math.floor((b-f+1)/3), h=(19*a+b-d-g+15)%30;
    const i=Math.floor(c/4), k=c%4, l=(32+2*e+2*i-h-k)%7;
    const m=Math.floor((a+11*h+22*l)/451);
    const month=Math.floor((h+l-7*m+114)/31), day=((h+l-7*m+114)%31)+1;
    return gregorianToJD(y, month, day);
  }
  add(easterJD(ceY), '‡¶á‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶®‡¶°‡ßá ‚Äî ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶§‡ßç‡¶•‡¶æ‡¶® ‡¶¶‡¶ø‡¶¨‡¶∏','‚úùÔ∏è','tc','‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶®','‡¶Ø‡¶ø‡¶∂‡ßÅ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶™‡ßÅ‡¶®‡¶∞‡ßÅ‡¶§‡ßç‡¶•‡¶æ‡¶® ‡¶â‡¶¶‡¶Ø‡¶æ‡¶™‡¶®‡•§');
  add(easterJD(ceY)-2, '‡¶ó‡ßÅ‡¶° ‡¶´‡ßç‡¶∞‡¶æ‡¶á‡¶°‡ßá','‚úùÔ∏è','tc','‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶®','‡¶Ø‡¶ø‡¶∂‡ßÅ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶ï‡ßç‡¶∞‡ßÅ‡¶∂‡¶¨‡¶ø‡¶¶‡ßç‡¶ß ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®‡•§');

  fixedGreg(ceY,   2, 21, '‡¶è‡¶ï‡ßÅ‡¶∂‡ßá ‡¶´‡ßá‡¶¨‡ßç‡¶∞‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø ‚Äî ‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï ‡¶Æ‡¶æ‡¶§‡ßÉ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶¶‡¶ø‡¶¨‡¶∏','üåπ','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶≠‡¶æ‡¶∑‡¶æ ‡¶∂‡¶π‡¶ø‡¶¶‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶Æ‡¶∞‡¶£‡•§ ‡ßß‡ßØ‡ß´‡ß® ‡¶∏‡¶æ‡¶≤‡ßá‡¶∞ ‡¶≠‡¶æ‡¶∑‡¶æ ‡¶Ü‡¶®‡ßç‡¶¶‡ßã‡¶≤‡¶®‡•§');
  fixedGreg(ceY,   3,  8, '‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï ‡¶®‡¶æ‡¶∞‡ßÄ ‡¶¶‡¶ø‡¶¨‡¶∏','‚ôÄÔ∏è','tg','‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï','‡¶®‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶ì ‡¶Æ‡¶∞‡ßç‡¶Ø‡¶æ‡¶¶‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶¨‡¶∏‡•§');
  fixedGreg(ceY,   4, 23, '‡¶¨‡¶ø‡¶∂‡ßç‡¶¨ ‡¶¨‡¶á ‡¶¶‡¶ø‡¶¨‡¶∏','üìö','tg','‡¶Ü‡¶®‡ßç‡¶§‡¶∞‡ßç‡¶ú‡¶æ‡¶§‡¶ø‡¶ï','‡¶™‡¶æ‡¶†‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Ü‡¶ó‡ßç‡¶∞‡¶π ‡¶§‡ßà‡¶∞‡¶ø‡¶∞ ‡¶¨‡ßà‡¶∂‡ßç‡¶¨‡¶ø‡¶ï ‡¶¶‡¶ø‡¶¨‡¶∏‡•§');
  fixedGreg(ceY,   3, 26, '‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶¶‡¶ø‡¶¨‡¶∏ (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂)','üáßüá©','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶ò‡ßã‡¶∑‡¶£‡¶æ (‡ß®‡ß¨ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ö ‡ßß‡ßØ‡ß≠‡ßß)‡•§');
  fixedGreg(ceY,  12, 16, '‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º ‡¶¶‡¶ø‡¶¨‡¶∏ (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂)','üèÜ','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶Æ‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶Ø‡ßÅ‡¶¶‡ßç‡¶ß‡ßá ‡¶¨‡¶ø‡¶ú‡¶Ø‡¶º (‡ßß‡ß¨ ‡¶°‡¶ø‡¶∏‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡ßß‡ßØ‡ß≠‡ßß)‡•§');
  fixedGreg(ceY,  12, 25, '‡¶¨‡¶°‡¶º‡¶¶‡¶ø‡¶® ‚Äî ‡¶ï‡ßç‡¶∞‡¶ø‡¶∏‡¶Æ‡¶æ‡¶∏','üéÑ','tc','‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶®','‡¶Ø‡¶ø‡¶∂‡ßÅ ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶¶‡¶ø‡¶®‡•§');
  // ‚îÄ‚îÄ West Bengal / India specific ‚îÄ‚îÄ
  fixedGreg(ceY,  8, 15, '‡¶≠‡¶æ‡¶∞‡¶§‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ ‡¶¶‡¶ø‡¶¨‡¶∏','üáÆüá≥','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶≠‡¶æ‡¶∞‡¶§‡ßá‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ß‡ßÄ‡¶®‡¶§‡¶æ (‡ßß‡ß´ ‡¶Ü‡¶ó‡¶∏‡ßç‡¶ü ‡ßß‡ßØ‡ß™‡ß≠)‡•§');
  fixedGreg(ceY,  1, 26, '‡¶≠‡¶æ‡¶∞‡¶§‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶ú‡¶æ‡¶§‡¶®‡ßç‡¶§‡ßç‡¶∞ ‡¶¶‡¶ø‡¶¨‡¶∏','üáÆüá≥','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶≠‡¶æ‡¶∞‡¶§‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶® ‡¶ó‡ßÉ‡¶π‡ßÄ‡¶§ (‡ß®‡ß¨ ‡¶ú‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø ‡ßß‡ßØ‡ß´‡ß¶)‡•§');
  fixedGreg(ceY,  5,  9, '‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','üìñ','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶ï‡¶¨‡¶ø‡¶ó‡ßÅ‡¶∞‡ßÅ ‡¶∞‡¶¨‡ßÄ‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶®‡¶æ‡¶• ‡¶†‡¶æ‡¶ï‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ‡•§ ‡ß®‡ß´ ‡¶¨‡ßà‡¶∂‡¶æ‡¶ñ‡•§');
  fixedGreg(ceY,  5, 22, '‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ','üéµ','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶¨‡¶ø‡¶¶‡ßç‡¶∞‡ßã‡¶π‡ßÄ ‡¶ï‡¶¨‡¶ø ‡¶ï‡¶æ‡¶ú‡ßÄ ‡¶®‡¶ú‡¶∞‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Æ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ‡•§');
  fixedGreg(ceY+1, 8, 15, '‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º ‡¶∂‡ßã‡¶ï ‡¶¶‡¶ø‡¶¨‡¶∏ (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂)','üñ§','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶¨‡¶ô‡ßç‡¶ó‡¶¨‡¶®‡ßç‡¶ß‡ßÅ ‡¶∂‡ßá‡¶ñ ‡¶Æ‡ßÅ‡¶ú‡¶ø‡¶¨‡ßÅ‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶∂‡¶æ‡¶π‡¶æ‡¶¶‡¶§ ‡¶¨‡¶æ‡¶∞‡ßç‡¶∑‡¶ø‡¶ï‡ßÄ‡•§');
  fixedGreg(ceY+1,11,  4, '‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶® ‡¶¶‡¶ø‡¶¨‡¶∏ (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂)','üìú','tn','‡¶ú‡¶æ‡¶§‡ßÄ‡¶Ø‡¶º','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡ßá‡¶∞ ‡¶∏‡¶Ç‡¶¨‡¶ø‡¶ß‡¶æ‡¶® ‡¶ó‡ßÉ‡¶π‡ßÄ‡¶§ (‡ß™ ‡¶®‡¶≠‡ßá‡¶Æ‡ßç‡¶¨‡¶∞ ‡ßß‡ßØ‡ß≠‡ß®)‡•§');

  fixedBS(7, 1, '‡¶®‡¶¨‡¶æ‡¶®‡ßç‡¶® ‡¶â‡ßé‡¶∏‡¶¨','üåæ','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶®‡¶§‡ßÅ‡¶® ‡¶ß‡¶æ‡¶® ‡¶ì‡¶†‡¶æ‡¶∞ ‡¶Ü‡¶®‡¶®‡ßç‡¶¶‡ßá‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§ ‡¶™‡¶ø‡¶†‡¶æ-‡¶™‡¶æ‡¶Ø‡¶º‡ßá‡¶∏‡•§');
  fixedBS(8, 14,'‡¶™‡ßå‡¶∑ ‡¶™‡¶æ‡¶∞‡ßç‡¶¨‡¶£','üéë','tb2','‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ','‡¶®‡¶§‡ßÅ‡¶® ‡¶ó‡ßÅ‡¶°‡¶º ‡¶ì ‡¶ö‡¶æ‡¶≤‡ßá‡¶∞ ‡¶™‡¶ø‡¶†‡¶æ‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨‡•§ ‡¶Æ‡¶ï‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∞‡¶æ‡¶®‡ßç‡¶§‡¶ø‡•§');

  // ‚îÄ‚îÄ Pradosha Vrata (Trayodashi tithi, 13th ‚Äî both paksha) ‚îÄ‚îÄ
  // Observed on Trayodashi (tithi 12 = Shukla, 27 = Krishna)
  const pradoshaSeeds = [1,2,3,4,5,6,7,8,9,10,11,12].map(m => gregorianToJD(ceY, m, 10));
  pradoshaSeeds.forEach(seed => {
    add(findTithiJD(12, seed, false), '‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤ ‡¶™‡ßç‡¶∞‡¶¶‡ßã‡¶∑ ‡¶¨‡ßç‡¶∞‡¶§','üåô','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑ ‡¶§‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶¶‡¶∂‡ßÄ ‚Äî ‡¶∂‡¶ø‡¶¨‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶¶‡ßã‡¶∑ ‡¶¨‡ßç‡¶∞‡¶§‡•§');
    add(findTithiJD(27, seed, false), '‡¶ï‡ßÉ‡¶∑‡ßç‡¶£ ‡¶™‡ßç‡¶∞‡¶¶‡ßã‡¶∑ ‡¶¨‡ßç‡¶∞‡¶§','üåô','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶§‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶¶‡¶∂‡ßÄ ‚Äî ‡¶∂‡¶ø‡¶¨‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶¶‡ßã‡¶∑ ‡¶¨‡ßç‡¶∞‡¶§‡•§');
  });

  // ‚îÄ‚îÄ Sankat Chaturthi / Vinayaka Chaturthi (monthly Ganesh) ‚îÄ‚îÄ
  // Krishna Chaturthi (tithi 18+1=19? no: tithi 3 = Shukla, 18 = Krishna Chaturthi)
  pradoshaSeeds.forEach(seed => {
    add(findTithiJD(3,  seed, false), '‡¶¨‡¶ø‡¶®‡¶æ‡¶Ø‡¶º‡¶ï ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ','üêò','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑ ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ ‚Äî ‡¶ó‡¶£‡ßá‡¶∂ ‡¶™‡ßÇ‡¶ú‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶¨‡ßç‡¶∞‡¶§‡•§');
    add(findTithiJD(18, seed, false), '‡¶∏‡¶Ç‡¶ï‡¶∑‡ßç‡¶ü ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ','üêò','th','‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ','‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑ ‡¶ö‡¶§‡ßÅ‡¶∞‡ßç‡¶•‡ßÄ ‚Äî ‡¶∏‡¶Ç‡¶ï‡¶ü‡¶Æ‡ßã‡¶ö‡¶® ‡¶ó‡¶£‡ßá‡¶∂‡ßá‡¶∞ ‡¶¨‡ßç‡¶∞‡¶§‡•§');
  });

  fests.sort((a, b) => a.m !== b.m ? a.m - b.m : a.d - b.d);
  return fests;
}

// Cache fests per year to avoid recomputing
const _festCache = {};
function getFests(bsY) {
  if (!_festCache[bsY]) _festCache[bsY] = buildFestsForYear(bsY);
  return _festCache[bsY];
}



/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STATE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let SEL = { y: 1431, m: 0, d: 1 };
let TODAY_BS = { y: 1431, m: 0, d: 1 };

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MONTH GRID
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderGrid() {
  const { y: bY, m: bM } = SEL;
  document.getElementById('mname').textContent = LANG === 'en' ? EN_BN_M[bM] : BN_M[bM];
  const g1 = bengaliToGregorian(bY, bM, 1);
  const ceStart = g1.y;
  document.getElementById('myear').textContent = LANG === 'en'
    ? `${bn(bY)} BS ‚Ä¢ ${bn(ceStart)} CE`
    : `${bn(bY)} ‡¶¨‡¶ô‡ßç‡¶ó‡¶æ‡¶¨‡ßç‡¶¶ ‚Ä¢ ${bn(ceStart)} ‡¶ñ‡ßç‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶¨‡ßç‡¶¶`;

  // Festival map (dynamic, year-aware)
  const fmap = {};
  getFests(bY).filter(f => f.m === bM).forEach(f => {
    if (!fmap[f.d]) fmap[f.d] = [];
    fmap[f.d].push(f);
  });

  // First day weekday
  const firstDate = new Date(g1.y, g1.m - 1, g1.d);
  const startWD = firstDate.getDay(); // 0=Sun

  const totalDays = getBSMonthDays(bY, bM);
  const grid = document.getElementById('cgrid');
  grid.innerHTML = '';

  // Empty cells
  for (let i = 0; i < startWD; i++) {
    const c = document.createElement('div');
    c.className = 'cc emp';
    grid.appendChild(c);
  }

  for (let day = 1; day <= totalDays; day++) {
    const g = bengaliToGregorian(bY, bM, day);
    const jd = g.jd;
    const gDate = new Date(g.y, g.m - 1, g.d);
    const wd = gDate.getDay();
    const tithi = calcTithi(jd);
    const fests = fmap[day] || [];
    const isToday = bY === TODAY_BS.y && bM === TODAY_BS.m && day === TODAY_BS.d;
    const isSel = day === SEL.d;

    const c = document.createElement('div');
    let cls = 'cc';
    if (wd === 0) cls += ' sun';
    if (wd === 6) cls += ' sat';
    if (isToday) cls += ' tod';
    if (isSel) cls += ' sel';
    c.className = cls;
    c.onclick = () => { SEL.d = day; renderAll(); };

    if (isToday) {
      const lbl = document.createElement('span');
      lbl.className = 'tod-lbl'; lbl.textContent = LANG==='en'?'Today':'‡¶Ü‡¶ú';
      c.appendChild(lbl);
    }

    const dn = document.createElement('span');
    dn.className = 'dn'; dn.textContent = bn(day); c.appendChild(dn);

    const den = document.createElement('span');
    den.className = 'den'; den.textContent = g.d; c.appendChild(den);

    if (fests.length > 0) {
      const fl = document.createElement('div');
      fl.className = 'fl';
      fl.textContent = fests[0].e + ' ' + fests[0].name.split('‚Äî')[0].trim();
      c.appendChild(fl);
    }

    const dots = document.createElement('div');
    dots.className = 'dots';
    // Moon dot at full/new moon
    if (tithi.num === 14 || tithi.num === 29) {
      const d2 = document.createElement('div');
      d2.className = 'dot dm';
      d2.title = TITHIS_30[tithi.num];
      dots.appendChild(d2);
    }
    fests.slice(0, 5).forEach(() => {
      const d2 = document.createElement('div');
      d2.className = 'dot df';
      dots.appendChild(d2);
    });
    c.appendChild(dots);
    grid.appendChild(c);
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   DAY DETAIL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderDayDetail() {
  const { y: bY, m: bM, d: bD } = SEL;
  const g = bengaliToGregorian(bY, bM, bD);
  const jd = g.jd;
  const gDate = new Date(g.y, g.m - 1, g.d);
  const wd = gDate.getDay();

  const tithi = calcTithi(jd);
  const nak = calcNakshatra(jd);
  const yoga = calcYoga(jd);
  const kar = calcKarana(jd);
  const sun = sunRiseSet(jd);
  const hijri = gregorianToHijri(g.y, g.m, g.d);

  const tithiName = TITHIS_30[tithi.num];
  const paksha = tithi.num < 15 ? '‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑' : '‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑';
  const moonPhase = MOON_P[Math.floor(tithi.num / 30 * 8) % 8];
  const ritu = RITUS[Math.floor(bM / 2)];
  const ayana = bM >= 3 && bM <= 8 ? '‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£‡¶æ‡¶Ø‡¶º‡¶£' : '‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶æ‡¶Ø‡¶º‡¶£';

  // Festivals for this day (dynamic, year-aware)
  const fests = getFests(bY).filter(f => f.m === bM && f.d === bD);
  // Upcoming
  const upcoming = [];
  for (let delta = 1; delta <= 30 && upcoming.length < 5; delta++) {
    let nm = bM, nd = bD + delta;
    while (nd > getBSMonthDays(bY, nm)) { nd -= getBSMonthDays(bY, nm); nm = (nm + 1) % 12; }
    getFests(bY).filter(f => f.m === nm && f.d === nd)
         .forEach(f => upcoming.push({ ...f, offset: delta, nm, nd }));
  }
  const upUniq = upcoming.filter((v, i, a) => a.findIndex(x => x.name === v.name) === i).slice(0, 4);

  const isEn2 = LANG === 'en';
  const tN = isEn2 ? EN_TITHIS[tithi.num] : tithiName;
  const pN = isEn2 ? (tithi.num < 15 ? 'Shukla Paksha' : 'Krishna Paksha') : paksha;
  const rN = isEn2 ? EN_RITUS[Math.floor(bM/2)] : ritu;
  const aN = isEn2 ? (bM>=3&&bM<=8?'Dakshinayana':'Uttarayana') : ayana;
  const wdN = isEn2 ? EN_WD[wd] : BN_WD[wd];
  const mN = isEn2 ? EN_BN_M[bM] : BN_M[bM];
  const hiMN = isEn2 ? EN_HI_M[hijri.m-1] : HI_M[hijri.m-1];
  const nakN = isEn2 ? EN_NAKSH[nak.idx] : nak.name;
  const yogaN = isEn2 ? EN_YOGAS[yoga.idx] : yoga.name;
  // Chandrashtama indicator
  const moonRashiIdx2 = Math.floor(tithi.mlon / 30) % 12;
  const moonRashiName = isEn2 ? EN_RASHIS[moonRashiIdx2] : RASHIS[moonRashiIdx2];
  // Amrit Siddhi / Sarvartha Siddhi detection
  const SARV_NK2 = [12,4,0,16,7,26,3];
  const isSarvartha = calcNakshatra(jd - 0.5 + 0.5/24).idx === SARV_NK2[wd];
  const specialYoga = isSarvartha ? (isEn2 ? '‚≠ê Sarvartha Siddhi Yoga' : '‚≠ê ‡¶∏‡¶∞‡ßç‡¶¨‡¶æ‡¶∞‡ßç‡¶• ‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶ø ‡¶Ø‡ßã‡¶ó') : '';

  const panel = document.getElementById('ddet');
  panel.innerHTML = `
    <div class="ddet-hdr">
      <div class="dbn">${bn(bD)}</div>
      <div class="dinfo">
        <div class="dwd">${wdN}, ${mN} ${bn(bY)}</div>
        <div class="dsub">${g.d} ${ENG_M[g.m - 1]} ${g.y}</div>
        <div class="dsub">${pN} ‚Ä¢ ${tN} ${isEn2?'Tithi':'‡¶§‡¶ø‡¶•‡¶ø'}</div>
        <div class="dsub">${rN} ${isEn2?'Season':'‡¶ã‡¶§‡ßÅ'} ‚Ä¢ ${aN}${specialYoga?' ‚Ä¢ <span style="color:#f0c848">'+specialYoga+'</span>':''}</div>
      </div>
      <div class="dmoon">${moonPhase}</div>
    </div>
    <div class="dbody">
      <div class="dr"><span class="dk">${isEn2?'Tithi':'‡¶§‡¶ø‡¶•‡¶ø'}</span><span class="dv gold">${tN} (${pN})</span></div>
      <div class="dr"><span class="dk">${isEn2?'Tithi No.':'‡¶§‡¶ø‡¶•‡¶ø ‡¶ï‡ßç‡¶∞‡¶Æ‡¶æ‡¶ô‡ßç‡¶ï'}</span><span class="dv">${bn(tithi.num + 1)}/‡ß©‡ß¶</span></div>
      <div class="dr"><span class="dk">${isEn2?'Nakshatra':'‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞'}</span><span class="dv">${nakN}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Yoga':'‡¶Ø‡ßã‡¶ó'}</span><span class="dv">${yogaN}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Karana':'‡¶ï‡¶∞‡¶£'}</span><span class="dv">${kar.name}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Moon Rashi':'‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶∞‡¶æ‡¶∂‡¶ø'}</span><span class="dv blue">${moonRashiName}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Season / Ayana':'‡¶ã‡¶§‡ßÅ / ‡¶Ö‡¶Ø‡¶º‡¶®'}</span><span class="dv purp">${rN} ${isEn2?'Season':'‡¶ã‡¶§‡ßÅ'} ‚Ä¢ ${aN}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Sun Longitude':'‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßá‡¶∞ ‡¶¶‡ßç‡¶∞‡¶æ‡¶ò‡¶ø‡¶Æ‡¶æ'}</span><span class="dv">${bnf(tithi.slon, 2)}¬∞</span></div>
      <div class="dr"><span class="dk">${isEn2?'Moon Longitude':'‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶¶‡ßç‡¶∞‡¶æ‡¶ò‡¶ø‡¶Æ‡¶æ'}</span><span class="dv">${bnf(tithi.mlon, 2)}¬∞</span></div>
      <div class="dr"><span class="dk">${isEn2?'Hijri Date':'‡¶π‡¶ø‡¶ú‡¶∞‡¶ø ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ'}</span><span class="dv purp">${bn(hijri.d)} ${hiMN} ${bn(hijri.y)}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Shaka Era':'‡¶∂‡¶ï‡¶æ‡¶¨‡ßç‡¶¶'}</span><span class="dv">${bn(bY - 421)} ${isEn2?'Shaka':'‡¶∂‡¶ï‡¶æ‡¶¨‡ßç‡¶¶'}</span></div>
      <div class="dr"><span class="dk">${isEn2?'Julian Day':'‡¶ú‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶¶‡¶ø‡¶®'}</span><span class="dv blue">${bn(jd)}</span></div>
      <div class="sunrow">
        <div class="sunbox"><div class="si">üåÖ</div><div class="sl">${isEn2?'Sunrise':'‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º'}</div><div class="sv">${sun.rise || (isEn2?'Unknown':'‡¶Ö‡¶ú‡ßç‡¶û‡¶æ‡¶§')}</div></div>
        <div class="sunbox"><div class="si">üåá</div><div class="sl">${isEn2?'Sunset':'‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∏‡ßç‡¶§'}</div><div class="sv">${sun.set || (isEn2?'Unknown':'‡¶Ö‡¶ú‡ßç‡¶û‡¶æ‡¶§')}</div></div>
      </div>
      ${fests.length ? `
      <div class="fbox">
        <div class="fbox-t">üéä ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶â‡ßé‡¶∏‡¶¨ ‡¶ì ‡¶™‡¶æ‡¶∞‡ßç‡¶¨‡¶£</div>
        ${fests.map(f => `
          <div class="fitem">
            <span class="femoji">${f.e}</span>
            <div style="flex:1"><div class="fname">${f.name}</div><div class="fdesc">${f.desc}</div></div>
            <span class="ftag ${f.t}">${f.tl}</span>
          </div>`).join('')}
      </div>` : `<div style="text-align:center;color:var(--text2);font-size:.75rem;padding:.7rem 0;margin-top:.5rem">‡¶Ü‡¶ú ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶â‡ßé‡¶∏‡¶¨ ‡¶®‡ßá‡¶á</div>`}
      ${upUniq.length ? `
      <div class="upbox">
        <div class="up-t">üìÖ ‡¶Ü‡¶∏‡¶®‡ßç‡¶® ‡¶â‡ßé‡¶∏‡¶¨</div>
        ${upUniq.map(f => `
          <div class="upitem" onclick="jumpTo(${f.nm},${f.nd})">
            <span class="ue">${f.e}</span>
            <div style="flex:1"><div class="un">${f.name}</div><div class="ud">${BN_M[f.nm]} ${bn(f.nd)}</div></div>
            <span class="uo">${bn(f.offset)} ‡¶¶‡¶ø‡¶® ‡¶™‡¶∞‡ßá ‚ñ∂</span>
          </div>`).join('')}
      </div>` : ''}
    </div>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PANCHANG
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderPanchang() {
  const { y: bY, m: bM, d: bD } = SEL;
  const g = bengaliToGregorian(bY, bM, bD);
  const jd = g.jd;
  const gDate = new Date(g.y, g.m - 1, g.d);
  const wd = gDate.getDay();
  const tithi = calcTithi(jd);
  const nak = calcNakshatra(jd);
  const yoga = calcYoga(jd);
  const kar = calcKarana(jd);
  const ritu = RITUS[Math.floor(bM / 2)];
  const ayana = bM >= 3 && bM <= 8 ? '‡¶¶‡¶ï‡ßç‡¶∑‡¶ø‡¶£‡¶æ‡¶Ø‡¶º‡¶£' : '‡¶â‡¶§‡ßç‡¶§‡¶∞‡¶æ‡¶Ø‡¶º‡¶£';
  const hijri = gregorianToHijri(g.y, g.m, g.d);

  const mStr = LANG === 'en' ? EN_BN_M[bM] : BN_M[bM];
  document.getElementById('ptitle').textContent = LANG === 'en'
    ? `Panchang ‚Äî ${mStr} ${bn(bD)}, ${bn(bY)}`
    : `‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó ‚Äî ${mStr} ${bn(bD)}, ${bn(bY)}`;
  const isEn = LANG === 'en';
  const tithiDisp  = isEn ? EN_TITHIS[tithi.num] : TITHIS_30[tithi.num];
  const pakshaDisp = isEn ? (tithi.num < 15 ? 'Shukla Paksha' : 'Krishna Paksha') : (tithi.num < 15 ? '‡¶∂‡ßÅ‡¶ï‡ßç‡¶≤‡¶™‡¶ï‡ßç‡¶∑' : '‡¶ï‡ßÉ‡¶∑‡ßç‡¶£‡¶™‡¶ï‡ßç‡¶∑');
  const nakDisp    = isEn ? EN_NAKSH[nak.idx] : nak.name;
  const yogaDisp   = isEn ? EN_YOGAS[yoga.idx] : yoga.name;
  const wdDisp     = isEn ? EN_WD[wd] : BN_WD[wd];
  // Chandrashtama: moon is 8 nakshatras ahead of birth nakshatra ‚Äî show current nakshatra for awareness
  const chandrashtamaNote = '';
  document.getElementById('pgrid').innerHTML = [
    { k: isEn?'Tithi':'‡¶§‡¶ø‡¶•‡¶ø',       v: tithiDisp },
    { k: isEn?'Paksha':'‡¶™‡¶ï‡ßç‡¶∑',       v: pakshaDisp },
    { k: isEn?'Nakshatra':'‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞', v: nakDisp },
    { k: isEn?'Yoga':'‡¶Ø‡ßã‡¶ó',           v: yogaDisp },
    { k: isEn?'Karana':'‡¶ï‡¶∞‡¶£',         v: isEn ? kar.name : kar.name },
    { k: isEn?'Weekday':'‡¶¨‡¶æ‡¶∞',         v: wdDisp },
  ].map(p => `<div class="pi"><span class="pik">${p.k}</span><span class="piv">${p.v}</span></div>`).join('');

  const moonRashiIdx = Math.floor(tithi.mlon / 30) % 12;
  const sunRashiIdx  = Math.floor(tithi.slon / 30) % 12;
  const rituDisp = isEn ? EN_RITUS[Math.floor(bM/2)] : ritu;
  const ayanaDisp = isEn ? (bM>=3&&bM<=8?'Dakshinayana':'Uttarayana') : ayana;
  const hiMonthDisp = isEn ? EN_HI_M[hijri.m-1] : HI_M[hijri.m-1];

  // WB variant: 1 Baishakh = 15 April (Bengali Sanatan)
  const wbDay = REGION === 'WB' ? (bD === 1 && bM === 0 ? '(WB: ‡ßß‡ß´ ‡¶è‡¶™‡ßç‡¶∞‡¶ø‡¶≤)' : '') : '';

  document.getElementById('vdt').innerHTML = [
    { k: isEn?'Bengali Date':'‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ',   v: `${bn(bD)} ${isEn?EN_BN_M[bM]:BN_M[bM]}, ${bn(bY)}`, c: 'gold' },
    { k: isEn?'English Date':'‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ', v: `${g.d} ${ENG_M[g.m - 1]} ${g.y}`, c: '' },
    { k: isEn?'Hijri Date':'‡¶π‡¶ø‡¶ú‡¶∞‡¶ø ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ',    v: `${bn(hijri.d)} ${hiMonthDisp} ${bn(hijri.y)}`, c: 'purp' },
    { k: isEn?'Shaka Era':'‡¶∂‡¶ï‡¶æ‡¶¨‡ßç‡¶¶',            v: `${bn(bY - 421)} ${isEn?'Shaka':'‡¶∂‡¶ï‡¶æ‡¶¨‡ßç‡¶¶'}`, c: '' },
    { k: isEn?'Weekday':'‡¶¨‡¶æ‡¶∞',                 v: isEn?EN_WD[wd]:BN_WD[wd], c: 'gold' },
    { k: isEn?'Season':'‡¶ã‡¶§‡ßÅ',                  v: rituDisp + (isEn?' Season':' ‡¶ã‡¶§‡ßÅ'), c: '' },
    { k: isEn?'Ayana':'‡¶Ö‡¶Ø‡¶º‡¶®',                   v: ayanaDisp, c: '' },
    { k: isEn?'Sun Sign':'‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø ‡¶∞‡¶æ‡¶∂‡¶ø', v: `${bnf(tithi.slon,1)}¬∞ (${isEn?EN_RASHIS[sunRashiIdx]:RASHIS[sunRashiIdx]})`, c: '' },
    { k: isEn?'Moon Sign':'‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶∞‡¶æ‡¶∂‡¶ø', v: `${bnf(tithi.mlon,1)}¬∞ (${isEn?EN_RASHIS[moonRashiIdx]:RASHIS[moonRashiIdx]})`, c:'blue' },
    { k: isEn?'Moon Nakshatra':'‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞', v: isEn?EN_NAKSH[nak.idx]:nak.name, c: '' },
    { k: isEn?'Julian Day':'‡¶ú‡ßÅ‡¶≤‡¶ø‡¶Ø‡¶º‡¶æ‡¶® ‡¶¶‡¶ø‡¶®',       v: bn(jd), c: 'blue' },
  ].map(r => `<div class="vr"><span class="vrk">${r.k}</span><span class="vrv ${r.c}">${r.v}</span></div>`).join('');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MUHURTAS FOR SELECTED DAY
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderMuhurtas() {
  const { y: bY, m: bM, d: bD } = SEL;
  const g = bengaliToGregorian(bY, bM, bD);
  const jd = g.jd;
  const gDate = new Date(g.y, g.m - 1, g.d);
  const wd = gDate.getDay();

  const muhs = getMuhurtas(jd, bM, wd);
  const grid = document.getElementById('muhGrid');
  grid.innerHTML = muhs.map(m => {
    const cls = m.auspic === 'G' ? 'mg' : m.auspic === 'B' ? 'mb' : 'mn';
    const lbl = m.auspic === 'G' ? '‡¶∂‡ßÅ‡¶≠' : m.auspic === 'B' ? '‡¶Ö‡¶∂‡ßÅ‡¶≠' : '‡¶Æ‡¶ß‡ßç‡¶Ø‡¶Æ';
    const periodColor = m.period === '‡¶¨‡¶ø‡¶∂‡ßá‡¶∑' ? ' style="color:var(--bad)"' : '';
    return `<div class="muh-item">
      <div class="muh-left">
        <div class="muh-name">${m.name} <small style="font-size:.6rem;color:var(--text2)">(${m.period})</small></div>
        <div class="muh-desc">${m.desc}</div>
        <div class="muh-time">‚è± ${m.start} ‚Äì ${m.end}</div>
      </div>
      <span class="mbadge ${cls}">${lbl}</span>
    </div>`;
  }).join('');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FESTIVALS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let activeFM = -1;
function buildTabs() {
  const allLabel = LANG==='en' ? 'All Months' : '‡¶∏‡¶¨ ‡¶Æ‡¶æ‡¶∏';
  document.getElementById('mtabs').innerHTML =
    `<button class="mtab on" onclick="showFM(-1,this)">${allLabel}</button>` +
    BN_M.map((m, i) => `<button class="mtab" onclick="showFM(${i},this)">${LANG==='en'?EN_BN_M[i]:m}</button>`).join('');
}
function showFM(idx, btn) {
  activeFM = idx;
  document.querySelectorAll('.mtab').forEach(b => b.classList.remove('on'));
  btn.classList.add('on');
  filterF(document.getElementById('fsrch').value);
}
function filterF(q = '') {
  const ql = q.toLowerCase().trim();
  const cont = document.getElementById('fcont');
  cont.innerHTML = '';
  const groups = {};
  getFests(SEL.y).forEach(f => {
    if (activeFM !== -1 && f.m !== activeFM) return;
    if (ql && !f.name.toLowerCase().includes(ql) && !f.desc.toLowerCase().includes(ql) && !f.tl.includes(ql)) return;
    if (!groups[f.m]) groups[f.m] = [];
    groups[f.m].push(f);
  });
  let total = 0;
  Object.keys(groups).sort((a, b) => +a - +b).forEach(mi => {
    const fests = groups[mi]; total += fests.length;
    const sec = document.createElement('div');
    sec.innerHTML = `
      <div class="fmhdr" onclick="toggleAcc(this)">
        <span class="fmic">${M_ICO[mi]}</span>
        <span class="fmn">${LANG==='en'?EN_BN_M[mi]:BN_M[mi]}</span>
        <span class="fmc">${fests.length}</span>
        <span class="fmar">‚ñº</span>
      </div>
      <div class="fmbody">
        ${fests.map(f => `
          <div class="fi" onclick="jumpTo(${f.m},${f.d})">
            <div class="fidc"><div class="fid">${bn(f.d)}</div><div class="fie">${f.e}</div></div>
            <div><div class="fin">${f.name}</div><div class="fis">${f.desc.length > 55 ? f.desc.slice(0, 55) + '‚Ä¶' : f.desc}</div></div>
            <span class="ftag ${f.t}">${f.tl}</span>
          </div>`).join('')}
      </div>`;
    cont.appendChild(sec);
  });
  if (!total) {
    const d = document.createElement('div');
    d.style.cssText = 'padding:1.2rem;text-align:center;color:var(--text2);font-size:.78rem';
    d.textContent = LANG==='en' ? 'No festivals found' : '‡¶ï‡ßã‡¶®‡ßã ‡¶â‡ßé‡¶∏‡¶¨ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø';
    cont.appendChild(d);
  }
}
function toggleDayDet() {
  const body  = document.getElementById('dayDetBody');
  const arrow = document.getElementById('dayDetArrow');
  const open  = !body.classList.contains('hidden');
  body.classList.toggle('hidden', open);
  arrow.style.transform = open ? 'rotate(-90deg)' : '';
}

function togglePanch() {
  const body  = document.getElementById('panchBody');
  const arrow = document.getElementById('panchArrow');
  const open  = !body.classList.contains('hidden');
  body.classList.toggle('hidden', open);
  arrow.style.transform = open ? 'rotate(-90deg)' : '';
}

function toggleFest() {
  const body  = document.getElementById('festBody');
  const arrow = document.getElementById('festArrow');
  const open  = !body.classList.contains('hidden');
  body.classList.toggle('hidden', open);
  arrow.style.transform = open ? 'rotate(-90deg)' : '';
}

function toggleMuh() {
  const body  = document.getElementById('muhBody');
  const arrow = document.getElementById('muhArrow');
  const open  = !body.classList.contains('hidden');
  body.classList.toggle('hidden', open);
  arrow.style.transform = open ? 'rotate(-90deg)' : '';
}

function toggleAcc(hdr) {
  const body = hdr.nextElementSibling;
  const arr = hdr.querySelector('.fmar');
  body.classList.toggle('hidden');
  arr.style.transform = body.classList.contains('hidden') ? 'rotate(-90deg)' : '';
}
function jumpTo(month, day) {
  SEL.m = month; SEL.d = day;
  document.getElementById('inMonth').value = month;
  renderAll();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   NOW BADGE (real-time clock + auto date detection)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function updateNowBadge() {
  const now = new Date();
  const bs = gregorianToBengali(now.getFullYear(), now.getMonth() + 1, now.getDate());
  const h = now.getHours(), mi2 = now.getMinutes(), s = now.getSeconds();
  const t = `${bn(h)}:${mi2 < 10 ? '‡ß¶' + bn(mi2) : bn(mi2)}:${s < 10 ? '‡ß¶' + bn(s) : bn(s)}`;
  const wdLabel = LANG === 'en' ? EN_WD[now.getDay()] : BN_WD[now.getDay()];
  const mLabel  = LANG === 'en' ? EN_BN_M[bs.m] : BN_M[bs.m];
  const eraLabel= LANG === 'en' ? 'BS' : '‡¶¨‡¶ô‡ßç‡¶ó‡¶æ‡¶¨‡ßç‡¶¶';
  document.getElementById('nowBadge').textContent =
    `‚è∞ ${LANG==='en'?'Now':'‡¶è‡¶ñ‡¶®'}: ${wdLabel} ‚Ä¢ ${bn(bs.d)} ${mLabel}, ${bn(bs.y)} ${eraLabel} ‚Ä¢ ${t}`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MAIN RENDER
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderAll() {
  document.getElementById('inYear').value = SEL.y;
  document.getElementById('inMonth').value = SEL.m;
  // Pre-warm dynamic festival cache for this year
  getFests(SEL.y);
  renderGrid();
  renderDayDetail();
  renderPanchang();
  renderMuhurtas();
  filterF(document.getElementById('fsrch').value);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CONTROLS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function shiftM(dir) {
  SEL.m += dir;
  if (SEL.m > 11) { SEL.m = 0; SEL.y++; }
  if (SEL.m < 0)  { SEL.m = 11; SEL.y--; }
  SEL.d = 1;
  renderAll();
}

function shiftY(dir) {
  SEL.y += dir;
  SEL.d = 1;
  renderAll();
}

function goToday() {
  const now = new Date();
  const bs = gregorianToBengali(now.getFullYear(), now.getMonth() + 1, now.getDate());
  SEL = { y: bs.y, m: bs.m, d: bs.d };
  renderAll();
}

function resetAll() {
  // Clear festival search
  document.getElementById('fsrch').value = '';
  // Reset month filter to "all"
  activeFM = -1;
  document.querySelectorAll('.mtab').forEach(b => b.classList.remove('on'));
  const allTab = document.querySelector('.mtab');
  if (allTab) allTab.classList.add('on');
  // Go to today
  goToday();
}

function setTheme(t, btn) {
  // Remove 'on' from theme buttons only (not lang/region)
  document.querySelectorAll('.tb').forEach(b => {
    if (b.id!=='langBtn' && b.id!=='regionBtn') b.classList.remove('on');
  });
  btn.classList.add('on');
  document.body.className = t;
}

function toggleLang() {
  LANG = LANG === 'bn' ? 'en' : 'bn';
  const btn = document.getElementById('langBtn');
  if (btn) { btn.textContent = LANG==='en'?'üî§ ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ':'üî§ English'; btn.classList.toggle('on',LANG==='en'); }
  const wdh = document.getElementById('wdhdr');
  if (wdh) {
    const lbl = LANG==='en' ? ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'] : ['‡¶∞‡¶¨‡¶ø','‡¶∏‡ßã‡¶Æ','‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤','‡¶¨‡ßÅ‡¶ß','‡¶¨‡ßÉ‡¶π‡¶É','‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞','‡¶∂‡¶®‡¶ø'];
    [...wdh.children].forEach((el,i)=>el.textContent=lbl[i]);
  }
  document.querySelector('.hdr h2').textContent = LANG==='en'
    ? 'Accurate Panchang ‚Ä¢ Muhurtas ‚Ä¢ Festivals'
    : '‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶ô‡ßç‡¶ó ‚Ä¢ ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§ ‚Ä¢ ‡¶â‡ßé‡¶∏‡¶¨';
  // Rebuild festival tabs in correct language
  buildTabs();
  renderAll();
}

function toggleRegion() {
  REGION = REGION==='BD' ? 'WB' : 'BD';
  const btn = document.getElementById('regionBtn');
  if (btn) { btn.textContent = REGION==='BD'?'üáßüá© BD':'üáÆüá≥ WB'; btn.classList.toggle('on',REGION==='WB'); }
  // WB: 1 Baishakh = 15 April vs BD: 14 April
  // Clear festival cache when region changes
  Object.keys(_festCache).forEach(k=>delete _festCache[k]);
  renderAll();
}

document.getElementById('inMonth').addEventListener('change', function () {
  SEL.m = +this.value; SEL.d = 1; renderAll();
});
document.getElementById('inYear').addEventListener('change', function () {
  const v = parseInt(this.value);
  if (!isNaN(v)) { SEL.y = v; SEL.d = 1; renderAll(); }
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   INIT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
// Footer year
const cy = new Date().getFullYear();
document.getElementById('fy1').textContent = cy;
document.getElementById('fy2').textContent = cy;

// Auto detect today
const now = new Date();
const todayBS = gregorianToBengali(now.getFullYear(), now.getMonth() + 1, now.getDate());
TODAY_BS = { y: todayBS.y, m: todayBS.m, d: todayBS.d };
SEL = { y: todayBS.y, m: todayBS.m, d: todayBS.d };

buildTabs();
renderAll();
updateNowBadge();

// Live clock
setInterval(updateNowBadge, 1000);

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SERVICE WORKER REGISTRATION
   Only active when served from a real domain with sw.js
   present (e.g. your own hosting / Netlify / GitHub Pages).
   Silently skipped in sandboxed previews (claudeusercontent)
   where the SW cannot be registered ‚Äî the app works fully
   without it in those environments.
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
if ('serviceWorker' in navigator) {
  // Only attempt registration on real http/https origins that are NOT
  // known sandbox domains where SW registration always fails.
  const origin = location.hostname;
  const isSandbox = (
    origin.includes('claudeusercontent.com') ||
    origin.includes('localhost') === false && origin.includes('127.0.0.1') === false &&
    /^blob:|^about:|^null$/.test(location.protocol)
  );
  const isLocalhost = origin === 'localhost' || origin === '127.0.0.1';

  if (!isSandbox || isLocalhost) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('./sw.js')
        .then(reg => {
          console.log('[PWA] Service Worker registered. Scope:', reg.scope);
          reg.addEventListener('updatefound', () => {
            const w = reg.installing;
            w.addEventListener('statechange', () => {
              if (w.state === 'installed' && navigator.serviceWorker.controller) {
                showUpdateBanner();
              }
            });
          });
        })
        .catch(() => {
          // SW unavailable (missing file, wrong MIME, etc.) ‚Äî silently ignored.
        });
    });
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PWA INSTALL PROMPT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let deferredPrompt = null;

window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  deferredPrompt = e;
  showInstallBanner();
});

window.addEventListener('appinstalled', () => {
  hideInstallBanner();
  deferredPrompt = null;
  console.log('[PWA] App installed successfully!');
});

function showInstallBanner() {
  if (document.getElementById('installBanner')) return;
  const banner = document.createElement('div');
  banner.id = 'installBanner';
  banner.innerHTML = `
    <div style="background:linear-gradient(90deg,#1a0a40,#0a1828);border-top:2px solid #d4a030;
      padding:.6rem 1rem;display:flex;align-items:center;justify-content:space-between;
      gap:.8rem;font-family:'Noto Serif Bengali',serif;flex-wrap:wrap;
      position:fixed;bottom:0;left:0;right:0;z-index:9999;box-shadow:0 -4px 24px rgba(0,0,0,.5)">
      <div style="display:flex;align-items:center;gap:.6rem">
        <img src="icon-192.png" width="36" height="36" style="border-radius:8px">
        <div>
          <div style="font-size:.82rem;font-weight:700;color:#f0c848">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ</div>
          <div style="font-size:.68rem;color:#8888aa">‡¶π‡ßã‡¶Æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
        </div>
      </div>
      <div style="display:flex;gap:.5rem">
        <button onclick="doInstall()" style="background:#d4a030;color:#180800;border:none;
          border-radius:8px;padding:.38rem .9rem;font-family:inherit;font-size:.78rem;
          font-weight:700;cursor:pointer">‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button onclick="hideInstallBanner()" style="background:transparent;color:#8888aa;
          border:1px solid #333355;border-radius:8px;padding:.38rem .7rem;
          font-family:inherit;font-size:.78rem;cursor:pointer">‡¶™‡¶∞‡ßá</button>
      </div>
    </div>`;
  document.body.appendChild(banner);
}

function hideInstallBanner() {
  const b = document.getElementById('installBanner');
  if (b) b.remove();
}

function doInstall() {
  if (!deferredPrompt) return;
  deferredPrompt.prompt();
  deferredPrompt.userChoice.then(choice => {
    if (choice.outcome === 'accepted') console.log('[PWA] User accepted install');
    deferredPrompt = null;
    hideInstallBanner();
  });
}

function showUpdateBanner() {
  if (document.getElementById('updateBanner')) return;
  const banner = document.createElement('div');
  banner.id = 'updateBanner';
  banner.innerHTML = `
    <div style="background:linear-gradient(90deg,#1a2800,#001828);border-top:2px solid #44bb55;
      padding:.5rem 1rem;display:flex;align-items:center;justify-content:space-between;
      gap:.8rem;font-family:'Noto Serif Bengali',serif;flex-wrap:wrap;
      position:fixed;top:0;left:0;right:0;z-index:9999;box-shadow:0 4px 24px rgba(0,0,0,.5)">
      <div style="font-size:.78rem;color:#ede5d8">üîÑ ‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶ó‡ßá‡¶õ‡ßá!</div>
      <button onclick="location.reload()" style="background:#44bb55;color:#001800;border:none;
        border-radius:8px;padding:.34rem .8rem;font-family:inherit;font-size:.75rem;
        font-weight:700;cursor:pointer">‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    </div>`;
  document.body.appendChild(banner);
}
</script>
</body>
</html>